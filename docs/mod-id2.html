<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Modélisation et identification causale, vol. 2 | Toutes les méthodes du master</title>
  <meta name="description" content="4 Modélisation et identification causale, vol. 2 | Toutes les méthodes du master" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Modélisation et identification causale, vol. 2 | Toutes les méthodes du master" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="pyrrhamide/regressions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Modélisation et identification causale, vol. 2 | Toutes les méthodes du master" />
  
  
  

<meta name="author" content="KF" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="log-lin.html"/>
<link rel="next" href="an-long.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Méthodes du master</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="part"><span><b>I Démarrage</b></span></li>
<li class="chapter" data-level="" data-path="stat-desc.html"><a href="stat-desc.html"><i class="fa fa-check"></i>Statistiques descriptives</a></li>
<li class="chapter" data-level="" data-path="nettoyage.html"><a href="nettoyage.html"><i class="fa fa-check"></i>Nettoyage des données</a></li>
<li class="part"><span><b>II Méthodes de régressions</b></span></li>
<li class="chapter" data-level="1" data-path="reg-lin.html"><a href="reg-lin.html"><i class="fa fa-check"></i><b>1</b> Régressions linéaires</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reg-lin.html"><a href="reg-lin.html#moindres-carrés-ordinaires---hypothèses"><i class="fa fa-check"></i><b>1.1</b> Moindres Carrés Ordinaires - hypothèses</a></li>
<li class="chapter" data-level="1.2" data-path="reg-lin.html"><a href="reg-lin.html#régressions-linéaires-simple-et-multiple"><i class="fa fa-check"></i><b>1.2</b> Régressions linéaires simple et multiple</a></li>
<li class="chapter" data-level="1.3" data-path="reg-lin.html"><a href="reg-lin.html#régression-linéaire-de-probabilité"><i class="fa fa-check"></i><b>1.3</b> Régression linéaire de probabilité</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reg-log.html"><a href="reg-log.html"><i class="fa fa-check"></i><b>2</b> Régressions logistiques</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reg-log.html"><a href="reg-log.html#régression-logistique-dichotomique"><i class="fa fa-check"></i><b>2.1</b> Régression logistique dichotomique</a></li>
<li class="chapter" data-level="2.2" data-path="reg-log.html"><a href="reg-log.html#régression-logistique-polytomique"><i class="fa fa-check"></i><b>2.2</b> Régression logistique polytomique</a></li>
<li class="chapter" data-level="2.3" data-path="reg-log.html"><a href="reg-log.html#odds-ratio-complet"><i class="fa fa-check"></i><b>2.3</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="log-lin.html"><a href="log-lin.html"><i class="fa fa-check"></i><b>3</b> Régression log-linéaire</a>
<ul>
<li class="chapter" data-level="3.1" data-path="log-lin.html"><a href="log-lin.html#modèle-de-lindépendance"><i class="fa fa-check"></i><b>3.1</b> Modèle de l’indépendance</a></li>
<li class="chapter" data-level="3.2" data-path="log-lin.html"><a href="log-lin.html#modèles-avec-interaction"><i class="fa fa-check"></i><b>3.2</b> Modèles avec interaction</a></li>
<li class="chapter" data-level="3.3" data-path="log-lin.html"><a href="log-lin.html#analyse-de-deviance"><i class="fa fa-check"></i><b>3.3</b> Analyse de deviance</a></li>
<li class="chapter" data-level="3.4" data-path="log-lin.html"><a href="log-lin.html#odds-ratio"><i class="fa fa-check"></i><b>3.4</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-id2.html"><a href="mod-id2.html"><i class="fa fa-check"></i><b>4</b> Modélisation et identification causale, vol. 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-id2.html"><a href="mod-id2.html#approches-expérimentales"><i class="fa fa-check"></i><b>4.1</b> Approches expérimentales</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="mod-id2.html"><a href="mod-id2.html#expériences-aléatoires-contrôlées"><i class="fa fa-check"></i><b>4.1.1</b> Expériences aléatoires contrôlées</a></li>
<li class="chapter" data-level="4.1.2" data-path="mod-id2.html"><a href="mod-id2.html#expériences-naturelles"><i class="fa fa-check"></i><b>4.1.2</b> Expériences naturelles</a></li>
<li class="chapter" data-level="4.1.3" data-path="mod-id2.html"><a href="mod-id2.html#différences-de-différences-differences-in-differences"><i class="fa fa-check"></i><b>4.1.3</b> Différences-de-différences (<em>differences-in-differences</em>)</a></li>
<li class="chapter" data-level="4.1.4" data-path="mod-id2.html"><a href="mod-id2.html#régression-par-discontinuité-regression-discontinuity-design"><i class="fa fa-check"></i><b>4.1.4</b> Régression par discontinuité (<em>Regression discontinuity design</em>)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mod-id2.html"><a href="mod-id2.html#variables-instrumentales"><i class="fa fa-check"></i><b>4.2</b> Variables instrumentales</a></li>
<li class="chapter" data-level="4.3" data-path="mod-id2.html"><a href="mod-id2.html#econométrie-des-panels"><i class="fa fa-check"></i><b>4.3</b> Econométrie des panels</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="mod-id2.html"><a href="mod-id2.html#le-modèle-homogène-ou-pooled"><i class="fa fa-check"></i><b>4.3.1</b> Le modèle homogène, ou <em>pooled</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="mod-id2.html"><a href="mod-id2.html#les-modèles-à-effet-aléatoire"><i class="fa fa-check"></i><b>4.3.2</b> Les modèles à effet aléatoire</a></li>
<li class="chapter" data-level="4.3.3" data-path="mod-id2.html"><a href="mod-id2.html#le-problème-dhétérogénéité-inobservée"><i class="fa fa-check"></i><b>4.3.3</b> Le problème d’hétérogénéité inobservée</a></li>
<li class="chapter" data-level="4.3.4" data-path="mod-id2.html"><a href="mod-id2.html#se-concentrer-sur-la-variance-interindividuelle-et-éliminer-la-variance-intra-individuelle"><i class="fa fa-check"></i><b>4.3.4</b> Se concentrer sur la variance interindividuelle et éliminer la variance intra-individuelle</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="an-long.html"><a href="an-long.html"><i class="fa fa-check"></i><b>5</b> Analyses longitudinales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="an-long.html"><a href="an-long.html#pseudo-panels"><i class="fa fa-check"></i><b>5.1</b> Pseudo-panels</a></li>
<li class="chapter" data-level="5.2" data-path="an-long.html"><a href="an-long.html#modèles-linéaires"><i class="fa fa-check"></i><b>5.2</b> Modèles linéaires</a></li>
<li class="chapter" data-level="5.3" data-path="an-long.html"><a href="an-long.html#modèles-dynamiques"><i class="fa fa-check"></i><b>5.3</b> Modèles dynamiques</a></li>
<li class="chapter" data-level="5.4" data-path="an-long.html"><a href="an-long.html#modèles-non-linéaires"><i class="fa fa-check"></i><b>5.4</b> Modèles non-linéaires</a></li>
<li class="chapter" data-level="5.5" data-path="an-long.html"><a href="an-long.html#modèles-de-durée"><i class="fa fa-check"></i><b>5.5</b> Modèles de durée</a></li>
<li class="chapter" data-level="5.6" data-path="an-long.html"><a href="an-long.html#optimal-matching"><i class="fa fa-check"></i><b>5.6</b> Optimal matching</a></li>
</ul></li>
<li class="part"><span><b>III Autres méthodes</b></span></li>
<li class="chapter" data-level="6" data-path="an-res.html"><a href="an-res.html"><i class="fa fa-check"></i><b>6</b> Analyses de réseaux</a>
<ul>
<li class="chapter" data-level="6.1" data-path="an-res.html"><a href="an-res.html#bases-de-la-théorie"><i class="fa fa-check"></i><b>6.1</b> Bases de la théorie</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="an-res.html"><a href="an-res.html#matrices"><i class="fa fa-check"></i><b>6.1.1</b> Matrices</a></li>
<li class="chapter" data-level="6.1.2" data-path="an-res.html"><a href="an-res.html#liens"><i class="fa fa-check"></i><b>6.1.2</b> Liens</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="an-res.html"><a href="an-res.html#structures-locales"><i class="fa fa-check"></i><b>6.2</b> Structures locales</a></li>
<li class="chapter" data-level="6.3" data-path="an-res.html"><a href="an-res.html#connectivité"><i class="fa fa-check"></i><b>6.3</b> Connectivité</a></li>
<li class="chapter" data-level="6.4" data-path="an-res.html"><a href="an-res.html#mesures-basiques-de-cohésion"><i class="fa fa-check"></i><b>6.4</b> Mesures basiques de cohésion</a></li>
<li class="chapter" data-level="6.5" data-path="an-res.html"><a href="an-res.html#mesures-de-diversité"><i class="fa fa-check"></i><b>6.5</b> Mesures de diversité</a></li>
<li class="chapter" data-level="6.6" data-path="an-res.html"><a href="an-res.html#mesures-de-centralité"><i class="fa fa-check"></i><b>6.6</b> Mesures de centralité</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Toutes les méthodes du master</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-id2" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Modélisation et identification causale, vol. 2</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="mod-id2.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lfe)</span>
<span id="cb22-2"><a href="mod-id2.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb22-3"><a href="mod-id2.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb22-4"><a href="mod-id2.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb22-5"><a href="mod-id2.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<p>Je mets immédiatement les lignes de codes complètes ici. Il est fortement recommandé d’utiliser la fonction <code>felm()</code> du package <code>lfe</code> pour toutes les techniques de ce cours, mais il est aussi possible d’utiliser <code>lm()</code>, <code>plm()</code> ou <code>ivreg()</code> pour de petites vérifications.</p>
<p>La fonction <code>felm()</code> fait tout: les effets fixes, les effets aléatoires, les variables instrumentales, la clusterisation des erreurs-types…it’s the GOAT 🐐.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="mod-id2.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## La syntaxe des commandes principales ##</span></span>
<span id="cb23-2"><a href="mod-id2.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> f1 <span class="sc">+</span> f2 <span class="sc">|</span> x3 <span class="sc">+</span> x4 <span class="sc">|</span> clu1 <span class="sc">+</span> clu2, data, weights, ...)</span>
<span id="cb23-3"><a href="mod-id2.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soit</span></span>
<span id="cb23-4"><a href="mod-id2.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(var_dep <span class="sc">~</span> vars_indep <span class="sc">|</span> vars_effet_fixe <span class="sc">|</span> vars_instrumentales <span class="sc">|</span> vars_cluster_se, data, weights, ...)</span>
<span id="cb23-5"><a href="mod-id2.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># si on veut seulement clusteriser les erreurs-types, on remplace</span></span>
<span id="cb23-6"><a href="mod-id2.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vars_effet_fixe et/ou vars_instrumentales par 0</span></span>
<span id="cb23-7"><a href="mod-id2.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1<span class="sc">+</span>x2 <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>clu1<span class="sc">+</span>clu2, data, weights, ...)</span>
<span id="cb23-8"><a href="mod-id2.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="mod-id2.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les variables instrumentales - plus détaillé plus tard</span></span>
<span id="cb23-10"><a href="mod-id2.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb23-11"><a href="mod-id2.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># soit</span></span>
<span id="cb23-12"><a href="mod-id2.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(var_dep <span class="sc">~</span> var_endo <span class="sc">+</span> vars_indep <span class="sc">|</span> vars_exo_inst, data, weights, ...)</span>
<span id="cb23-13"><a href="mod-id2.html#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="mod-id2.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les données de panel/effets fixes et tout ça</span></span>
<span id="cb23-15"><a href="mod-id2.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;var_indiv&quot;</span>,<span class="st">&quot;var_temps&quot;</span>), data, <span class="at">model =</span> <span class="st">&quot;pooling&quot;</span>)</span>
<span id="cb23-16"><a href="mod-id2.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># voir la documentation pour les autres &quot;model&quot; et également les &quot;effect&quot;.</span></span></code></pre></div>
<div id="approches-expérimentales" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Approches expérimentales</h2>
<p>Groupe traité v groupe de contrôle.</p>
<p>Pour connaître l’effet du traitement, groupe ‘traité’ diffère du groupe de contrôle seulement du traitement.</p>
<p>4 méthodes autour de cette idée:</p>
<ol style="list-style-type: decimal">
<li>Expériences aléatoires contrôlées</li>
<li>Expériences naturelles</li>
<li>Différences de différences</li>
<li>Régression par discontinuité</li>
</ol>
<div id="expériences-aléatoires-contrôlées" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Expériences aléatoires contrôlées</h3>
<p>2 exemples d’expériences aléatoires contrôlées:</p>
<ul>
<li>Expérience à essais randomisés contrôlés (<em>randomised controlled trials (RCT) experiments</em>)</li>
<li>Expériences par questionnaire (<em>randomised survey experiment</em>)</li>
</ul>
<p>On prend un groupe qui rempli les mêmes caractéristiques (du type la promo du M2) à qui on applique un ou des traitements différents pour voir si les résultats sur une variable à expliquer diffèrent.</p>
<p>Il y a deux directrices. On est allés voir l’une ou l’autre l’année dernière (dans le contexte de l’expérience aléatoire, disons qu’on les a choisi aléatoirement) et c’est celle qu’on a vu qui est devenue notre interlocutrice principale (c’est la ventilation aléatoire il me semble). Du coup, au sein de la promo (normalement uniforme mais tmtc que nan), on est soumis à un traitement différent selon la dir. Y a-t-il une différence de notes/de moral en fonction de la personne ?</p>
<p>Dans cette situation que je viens de décrire, il devrait normalement y avoir un troisième groupe (groupe de contrôle - indépendance du traitement) sans interlocutrice.</p>
<p><strong>Pourquoi l’expérience randomisée ?</strong></p>
<ul>
<li>Ventilation aléatoire assure que toutes les caractéristiques des individus (à la fois observées et surtout inobservées) vont être ventilées de manière équiprobable dans les groupes traités ou de contrôle.</li>
<li>L’estimation n’est plus biaisée par une variable confondante (hétérogénéité inobservée)</li>
<li>Simplification considérable de la statistique
<ul>
<li>intensité indiquée par la différence (ou le rapport) des moyennes</li>
<li>significativité test de différence de moyennes ou de proportions [préciser le.s tests en question]</li>
</ul></li>
<li>Expérience aléatoire versus échantillon aléatoire
<ul>
<li>échantillon aléatoire: établir des statistiques représentatives d’une population <span class="math inline">\(\rightarrow\)</span> validité externe [définir ce que c’est].</li>
<li>expérience aléatoire: ventilation aléatoire d’un échantillon <span class="math inline">\(\rightarrow\)</span> validité interne [définir].</li>
</ul></li>
</ul>
<p><strong>L’expérience et ses aveugles</strong></p>
<ul>
<li>Simple aveugle: le patient ne sait pas dans quel groupe il est (traité ou placebo)</li>
<li>Double aveugle: le patient et la personne qui administre le traitement ne savent pas dans quel groupe se trouve le patient</li>
<li>Triple aveugle: le patient, la personne qui administre le traitement et le statisticien ne savent pas dans quel groupe se trouve le patient.</li>
</ul>
<p>L’expérience aléatoire en sciences sociales est rarement une expérience avec placebo et en aveugle. Le placebo, qui doit avoir la forme, le goût, etc. du placebo, n’existe pas toujours [trouver exemple]. Il y a souvent 2 groupes: un qui fait l’objet d’une intervention et un qui ne reçoit rien. Il importe alors d’être vigilent à faire une analyse en intention de traiter (<em>intention to treat</em>) plutôt que traitement réalisé (<em>treatment on treated</em>).</p>
<p>[parler des limites techniques et conceptuelles?]</p>
</div>
<div id="expériences-naturelles" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Expériences naturelles</h3>
<ul>
<li>Situation “naturelle” qui ressemble à une situation expérimentale (ventilation aléatoire ou quasi-aléatoire d’une population entre groupe traité et groupe de contrôle) sans avoir été construite à des fins expérimentales.</li>
<li>Tirages au sort comme procédure d’allocation (e.g. jurés en tribunal, distribution dans les chambres d’internat, répartition entre ceux qui ont dû présenter leur problématique de mémoire le jour 1 et le jour 2)</li>
<li>Autres exemples : jeux aléatoires et loteries, phénomène aléatoires ou quasi aléatoires (sexe de l’enfant/mois de naissance), recrutement académique…</li>
</ul>
<p>[EXEMPLE!!!]</p>
</div>
<div id="différences-de-différences-differences-in-differences" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Différences-de-différences (<em>differences-in-differences</em>)</h3>
<p>On reprend l’opposition groupe traité versus groupe de contrôle des expériences contrôlées. Toutefois, on n’est pas sûr que les groupes de contrôles soient vraiment similaires en tout point excepté le traitement. On va faire une hypothèse plus faible: la différence entre traitement et contrôle est constante dans le temps.</p>
<ul>
<li>différence prétraitement est la différence liée aux “inobservables”</li>
<li>différence post-traitement est la différence liée aux “inobservables” + effet causal</li>
<li>différence de différence est l’effet causal (diff post - diff pré)</li>
</ul>
<p>Différence “standard” :
<span class="math display">\[Traité - Contrôle \\ T_1 - C_1\]</span>
Différence de différence est l’estimation :
<span class="math display">\[DiD = (Traité_{post}-Traité_{anté})-(Contrôle_{post}-Contrôle_{anté}) \\ DiD = (T_1-T_0)-(C_1-C_0)\]</span></p>
<p>Notations classiques :<br />
- <span class="math inline">\(T_1=\mu_{11}\)</span> ; <span class="math inline">\(T_0=\mu_{10}\)</span> ; <span class="math inline">\(C_1=\mu_{01}\)</span> ; <span class="math inline">\(C_0=\mu_{00}\)</span><br />
- Diff-in-Diff = <span class="math inline">\((\mu_{11}-\mu_{01})-(\mu_{10}-\mu_{00})\)</span></p>
<p><strong>Estimations économétriques</strong><br />
Quand on a un panel :<br />
- on mesure sur les mêmes individus, l’avant et l’après,<br />
- on estime l’évolution,<br />
- <span class="math inline">\(\Delta y_i = \beta_0 + \beta_1 GT + \epsilon_i\)</span> ou GT est le groupe traité,<br />
- <span class="math inline">\(\Delta y_i\)</span> est l’évolution/la variation de <span class="math inline">\(y_i\)</span>
- <span class="math inline">\(\beta_0\)</span> est l’intercept [nom spécial en DiD?]
- <span class="math inline">\(\beta_1\)</span> est l’estimateur DiD.
- <span class="math inline">\(\epsilon_i\)</span> est le terme d’erreur [distribution spéciale?]</p>
<p>Quand on n’a pas de panel :<br />
- les individus avant et après ne sont pas les mêmes,<br />
- <span class="math inline">\(y_{it} = \beta_0 + \beta_1 GT + \beta_2 t + \beta_3 t \times GT + \epsilon_{it}\)</span>,<br />
- <span class="math inline">\(\beta_3\)</span> est l’estimateur DiD.</p>
<p><strong>Portées et limites</strong></p>
<ul>
<li>Hypothèses fortes:
<ul>
<li>la différence entre le traitement et le contrôle serait restée constante en l’absence de traitement.</li>
<li>ou redit autrement, la différence de différence est unniquement due au “traitement” et non à un autre changement intervenu dans le groupe traité entre la période 1 et 2.</li>
</ul></li>
<li>Si on dispose de plus de deux périodes, on peut faire une vérification graphique.</li>
</ul>
</div>
<div id="régression-par-discontinuité-regression-discontinuity-design" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Régression par discontinuité (<em>Regression discontinuity design</em>)</h3>
<p>Les groupes sont ventilés pour recevoir ou non un traitement en fonction d’un seuil sur une variable mesurable (continue). Par exemple, les personnes qui sont arrêtées au-delà d’un seuil d’alcool dans le sang ont l’obligation de suivre un traitement, et les groupes au-dessous de ce seuil servent de groupe de comparaison (groupe de contrôle). L’effet est mesuré au niveau de la discontinuité entre le groupe traité et le groupe de contrôle (on ne fait pas la différence de moyenne entre deux groupes).</p>
<p><strong>Conditions d’applications</strong></p>
<p>Le seuil est exogène, non manipulable, et déclenche les actions:</p>
<ul>
<li>majorité absolue <span class="math inline">\(\rightarrow\)</span> effet de l’élection</li>
<li>rang du dernier poste offert au concours <span class="math inline">\(\rightarrow\)</span> effet de l’école</li>
<li>seuil de déclenchement d’une mesure sociale ou fiscale <span class="math inline">\(\rightarrow\)</span> effet de la politique, etc…</li>
</ul>
<p><strong>Avantages et désavantages</strong></p>
<p>Avantages: quand c’est bien effectué, la régression par discontinuité permet une estimation non biaisée du traitement.</p>
<p>Désavantages:</p>
<ul>
<li>la puissance statistique est bien moindre que dans des essais randomisés contrôlés portant sur le même effectif. L’attention à la puissance statistique est cruciale.</li>
<li>les effets sont sans biais uniquement si la forme fonctionnelle entre la variable d’assignation et la variable de résultat est bien modélisée, y compris:
<ul>
<li>des relations non-linéaires (augmentation - plateau - augmentation)</li>
<li>des interactions (pente coef 1 - seuil - pente coef 2)</li>
</ul></li>
</ul>
<p><strong>Estimations économétriques</strong><br />
Le modèle linéaire simple (premières estimations)<br />
- <span class="math inline">\(y_i = \beta_0 + \beta_1 x + \beta_2 (x&gt;seuil) + \epsilon_i\)</span>,<br />
- L’effet causal est mesuré par <span class="math inline">\(\beta_2\)</span>,<br />
- Limite suppose que la forme fonctionnelle est la même de part et d’autre du seuil (en gros, que le coefficient de la pente soit pas trop différent à gauche et à droite de la discontinuité).</p>
<p>Le modèle linéaire avec changement de pente<br />
- <span class="math inline">\(y_i = \beta_0 + \beta_1 x + \beta_2 (x&gt;seuil) + \beta_3x \times (x&gt;seuil) + \epsilon_i\)</span><br />
- l’effet causal est mesuré par <span class="math inline">\(\beta_2\)</span>.
- différence avec modèle linéaire simple: on interagit <span class="math inline">\(x\)</span> pré-seuil et post-seuil.</p>
<p>Le modèle linéaire avec changement de forme<br />
- attention de bien centrer la variable <span class="math inline">\(x\)</span> autour du seuil ! <span class="math inline">\(x&#39; = x-seuil\)</span>,<br />
- <span class="math inline">\(y_i = \beta_0 + \beta_1 x&#39; + \beta_2 x^{&#39;2} + \beta_3(x&#39;&gt;0) + \beta_4x&#39; \times (x&#39;&gt;0) + \beta_5 x^{&#39;2} \times (x&#39;&gt;0) + \epsilon_i\)</span>,<br />
- l’effet causal est mesuré par <span class="math inline">\(\beta_3\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="mod-id2.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression discontinuity design - je recommende de regarder directement le code du prof et de lancer les commandes.</span></span>
<span id="cb24-2"><a href="mod-id2.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="mod-id2.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># recentrage de la variable autour du seuil</span></span>
<span id="cb24-4"><a href="mod-id2.html#cb24-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>var_cont_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>var_continue <span class="sc">-</span> valeur_seuil_au_choix <span class="co"># commande parmi plein d&#39;autres, là c&#39;est toi qui prend l&#39;initiative</span></span>
<span id="cb24-5"><a href="mod-id2.html#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="mod-id2.html#cb24-6" aria-hidden="true" tabindex="-1"></a>pr1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_continue<span class="sc">+</span><span class="fu">I</span>(var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix),<span class="at">data=</span>d)</span>
<span id="cb24-7"><a href="mod-id2.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># suppose que pente est la même à gauche et à droite du seuil</span></span>
<span id="cb24-8"><a href="mod-id2.html#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="mod-id2.html#cb24-9" aria-hidden="true" tabindex="-1"></a>pr1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_cont_cent<span class="sc">+</span><span class="fu">I</span>(var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>),<span class="at">data=</span>d)</span>
<span id="cb24-10"><a href="mod-id2.html#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="mod-id2.html#cb24-11" aria-hidden="true" tabindex="-1"></a>pr2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_continue<span class="sc">+</span><span class="fu">I</span>(var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">+</span></span>
<span id="cb24-12"><a href="mod-id2.html#cb24-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">I</span>((var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">*</span>var_continue),<span class="at">data=</span>d)</span>
<span id="cb24-13"><a href="mod-id2.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="mod-id2.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># pour cacher les points extrêmes de la base (pour garder la linéarité)</span></span>
<span id="cb24-15"><a href="mod-id2.html#cb24-15" aria-hidden="true" tabindex="-1"></a>pr2b <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_continue<span class="sc">+</span><span class="fu">I</span>(var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">+</span></span>
<span id="cb24-16"><a href="mod-id2.html#cb24-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>((var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">*</span>var_continue),</span>
<span id="cb24-17"><a href="mod-id2.html#cb24-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>d[d<span class="sc">$</span>var_continue<span class="sc">&gt;=</span>valeur1 <span class="sc">&amp;</span> d<span class="sc">$</span>var_continue<span class="sc">&lt;=</span>valeur2,])</span>
<span id="cb24-18"><a href="mod-id2.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># pr2 et pr2b supposent que l&#39;effet est linéaire des deux cotés du seuil</span></span>
<span id="cb24-19"><a href="mod-id2.html#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="mod-id2.html#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="mod-id2.html#cb24-21" aria-hidden="true" tabindex="-1"></a>pr3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_cont_cent<span class="sc">+</span></span>
<span id="cb24-22"><a href="mod-id2.html#cb24-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>(var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb24-23"><a href="mod-id2.html#cb24-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>((var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">*</span>var_cont_cent)<span class="sc">+</span></span>
<span id="cb24-24"><a href="mod-id2.html#cb24-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>((var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">*</span>var_cont_cent2),<span class="at">data=</span>d)</span></code></pre></div>
</div>
</div>
<div id="variables-instrumentales" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Variables instrumentales</h2>
<p>Violation de la 6ème hypothèse des MCO (<span class="math inline">\(Cov(x_i,\epsilon_i \neq 0)\)</span> absence de corrélation entre les variables explicatives et le résidu) <span class="math inline">\(\Rightarrow\)</span> <em>endogénéité</em>. Pb endogénéité peut conduire à se tromper dans l’interprétation des paramètres. Variables instrumentales comme technique de correction.</p>
<p>3 problèmes et leurs effets sur les paramètres:</p>
<ul>
<li>Erreur de mesure d’une variable explicative: sous-estimation de la valeur absolue du paramètre <span class="math inline">\(\beta_i\)</span>.</li>
<li>Variable omise ou hétérogénéité inobservée (corrélée à la variable dépendante et à une autre variable explicative): sur/sous-estimation de la valeur absolue du paramètre.</li>
<li>Simultanéité (variable explicative dépend de la variable expliquée): effet plus complexe. Pas d’intuition évidente.</li>
</ul>
<p>Solution <span class="math inline">\(\Rightarrow\)</span> variable instrumentale: trouver une variable instrumentale exogène qui impacte ma variable expliquée <span class="math inline">\(y_i\)</span> uniquement par l’intermédiaire de son effet sur la variable explicative <span class="math inline">\(x_i\)</span> suspecte d’endogénéité.
<span class="math display">\[ instrument \rightarrow var\_endo \rightarrow var\_dep\]</span></p>
<p>Sachant que <span class="math inline">\(cov(x_{endo},\epsilon) \neq 0\)</span>, on introduit une variable instrumentale (<span class="math inline">\(z_{inst}\)</span>) telle que:</p>
<ul>
<li><span class="math inline">\(cov(z_{inst},x_{endo}) \neq 0\)</span>, et</li>
<li><span class="math inline">\(cov(z_{inst},\epsilon) = 0\)</span></li>
</ul>
<p>Vrai modèle<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>: <span class="math inline">\(y = a_{vrai} + b_{vrai} x_{endo} + c_{vrai} x_2 + \epsilon\)</span> avec <span class="math inline">\(cov(x_{endo},\epsilon) \neq 0\)</span>.</p>
<p><strong>Première étape</strong>: on régresse la variable endogène à la fois sur l’instrument et sur les autres variables explicatives. NB: on met toutes les variables explicatives même non pertinentes en première étape.
<span class="math display">\[x_{endo} = a_0 + a_1 z_{inst} + a_2 x_2 + \epsilon_{prem}\]</span></p>
<p>On récupère de cette première régression <span class="math inline">\(x&#39;_{endo}\)</span>, la prédiction de la variable endogène <span class="math inline">\(x_{endo}\)</span>:
<span class="math display">\[x&#39;_{endo} = a_0 + a_1 z_{inst} + a_2 x_2 = x_{endo} - \epsilon_{prem}\]</span></p>
<p><strong>Deuxième étape</strong>: on introduit cette prédiction dans la régression à la place <span class="math inline">\(x_{endo}\)</span>.
<span class="math display">\[y = a_{est} + b_{est} x&#39;_{endo} + c_{est} x_2 + \epsilon_{deux}\]</span></p>
<p>Comme <span class="math inline">\(z_{inst}\)</span> et <span class="math inline">\(x_2\)</span> ne sont pas corrélés avec le résidu <span class="math inline">\(\epsilon\)</span>, alors <span class="math inline">\(x&#39;_{endo}\)</span> n’est plus corrélé avec <span class="math inline">\(\epsilon\)</span>, l’estimateur des variables instrumentales permet d’estimer sans biais <span class="math inline">\(b_{vrai}\)</span> (et le reste).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="mod-id2.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1ère façon de procéder ##</span></span>
<span id="cb25-2"><a href="mod-id2.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MCO &quot;naïve&quot;</span></span>
<span id="cb25-3"><a href="mod-id2.html#cb25-3" aria-hidden="true" tabindex="-1"></a>mco <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_endo <span class="sc">+</span> x1 <span class="sc">+</span> x2, data, weights, ...)</span>
<span id="cb25-4"><a href="mod-id2.html#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="mod-id2.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Forme réduite - impact des instruments sur variable dépendante (facultatif)</span></span>
<span id="cb25-6"><a href="mod-id2.html#cb25-6" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb25-7"><a href="mod-id2.html#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="mod-id2.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Première étape: regression endogene sur autres variables indépendantes et instruments</span></span>
<span id="cb25-9"><a href="mod-id2.html#cb25-9" aria-hidden="true" tabindex="-1"></a>pe <span class="ot">&lt;-</span> <span class="fu">lm</span>(x_endo <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb25-10"><a href="mod-id2.html#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="mod-id2.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Deuxième étape: on introduit la prediction dans la régression &quot;naïve&quot;</span></span>
<span id="cb25-12"><a href="mod-id2.html#cb25-12" aria-hidden="true" tabindex="-1"></a>mco2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> pe<span class="sc">$</span>fitted.values <span class="sc">+</span> x1 <span class="sc">+</span> x2, data, weights, ...)</span>
<span id="cb25-13"><a href="mod-id2.html#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="mod-id2.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Deuxième façon de procéder ##</span></span>
<span id="cb25-15"><a href="mod-id2.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Régression variable instrumentale directe, sans première étape</span></span>
<span id="cb25-16"><a href="mod-id2.html#cb25-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(y <span class="sc">~</span> x_endo <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb25-17"><a href="mod-id2.html#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="mod-id2.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour voir les coefficients de la première étape</span></span>
<span id="cb25-19"><a href="mod-id2.html#cb25-19" aria-hidden="true" tabindex="-1"></a>z<span class="sc">$</span>coefficients1</span>
<span id="cb25-20"><a href="mod-id2.html#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="mod-id2.html#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Documentation officielle [vérifier si dans cours]:</span></span>
<span id="cb25-22"><a href="mod-id2.html#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that exogenous regressors have to be included as instruments for themselves. For example, if there is one exogenous regressor ex and one endogenous regressor en with instrument in, the appropriate formula would be</span></span>
<span id="cb25-23"><a href="mod-id2.html#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> ex <span class="sc">+</span> en <span class="sc">|</span> ex <span class="sc">+</span> <span class="cf">in</span>)</span>
<span id="cb25-24"><a href="mod-id2.html#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="mod-id2.html#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Troisième façon de procéder ##</span></span>
<span id="cb25-26"><a href="mod-id2.html#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Régression avec instruments, sans effet fixe et sans clusterisation</span></span>
<span id="cb25-27"><a href="mod-id2.html#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x_endo <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span> z1<span class="sc">+</span> z2 <span class="sc">|</span><span class="dv">0</span>, data, weights, ...)</span></code></pre></div>
</div>
<div id="econométrie-des-panels" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Econométrie des panels</h2>
<p>L’économétrie des panels rend visible et permet de traiter deux problèmes classiques :
1. L’autocorrélation des résidus,
2. L’hétérogénéité inobservée.</p>
<p><strong>Autocorrélation des résidus</strong></p>
<ul>
<li><span class="math inline">\(Cov(\epsilon_{it},\epsilon_{it+1}) = 0\)</span> ?</li>
<li>Si je suis sous-payée à la date <span class="math inline">\(t\)</span>, je le serai sans doute à la date <span class="math inline">\(t+1\)</span>.</li>
</ul>
<p><strong>Hétérogénéité inobservée</strong></p>
<ul>
<li>Si <span class="math inline">\(\epsilon_{it} = v.inobs + e\)</span> et <span class="math inline">\(cov(x_{ik},inobs) \neq 0 \Rightarrow\)</span> biais.</li>
<li>Le résidu <span class="math inline">\(\epsilon_{it}\)</span> peut être réécrit de la manière suivante: <span class="math inline">\(\epsilon_{it} = \alpha_i + e_{it}\)</span>, comme la somme d’une erreur individuelle constante <span class="math inline">\(\alpha_i\)</span>, et <span class="math inline">\(e_{it}\)</span> une erreur temporaire.</li>
<li><span class="math inline">\(\alpha_i\)</span> peut être vu comme déterminé par les variables inobservées <em>constantes dans le temps</em>.</li>
<li>Question: peut-on dire que dans notre vrai modèle cette erreur constante <span class="math inline">\(\alpha_i\)</span> par individu est indépendante des variables explicatives, soit <span class="math inline">\(cov(\alpha_i,x_k) = 0\)</span> ?
<ul>
<li>Oui <span class="math inline">\(\rightarrow\)</span> estimation <em>pooling</em> ou aléatoire est la bonne.</li>
<li>Non <span class="math inline">\(\rightarrow\)</span> hypothèse des MCO <span class="math inline">\(cov(\epsilon_i,x_k) = 0\)</span> n’est pas respectée. Le modèle des MCO n’est pas consistant pour estimer les <span class="math inline">\(\beta \rightarrow\)</span> modèles à effets fixes ou en différences premières.</li>
</ul></li>
</ul>
<div id="le-modèle-homogène-ou-pooled" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Le modèle homogène, ou <em>pooled</em></h3>
<p>ou comment résoudre le problème d’autocorrélation des résidus.</p>
<p>Modèle estimé par les MCO: <span class="math inline">\(y_{it}=\beta_0+\beta_1 x_{it}+...+\beta_k x_{kit} + \epsilon_{it}\)</span></p>
<p>Le modèle <em>pooled/pooling</em> ou modèle homogène suppose que tous les résidus ont la même variance et qu’il n’y a pas d’autocorrélation des résidus.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="mod-id2.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, data)</span>
<span id="cb26-2"><a href="mod-id2.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ou</span></span>
<span id="cb26-3"><a href="mod-id2.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, data, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;individu&quot;</span>,<span class="st">&quot;temps&quot;</span>), <span class="at">model =</span> <span class="st">&quot;pooling&quot;</span>)</span></code></pre></div>
<p><strong>La résolution du problème d’autocorrélation des résidus</strong></p>
<p>Deux possibilités:</p>
<ol style="list-style-type: decimal">
<li>Corriger la matrice de variance covariance:
<ul>
<li>estimateur sandwich de Huber-White/ <em>robust standard errors</em> : on corrige les écart-types pour tenir compte de l’hétéroscédasticité des résidus (mais pas de l’autocorrélation) <span class="math inline">\(\rightarrow\)</span> hétérogénéité des variances des résidus.</li>
<li>correction par cluster / <em>robust clustered standard errors</em> : on corrige les écart-types pour tenir compte à la fois de l’hétéroscédasticité des résidus et de leur autocorrélation par cluster (individus, nations, famille…) <span class="math inline">\(\rightarrow\)</span> hétérogénéité des variances des résidus + résidus clusterisés donc homogénéité des variances des résidus au sein des groupes.</li>
</ul></li>
<li>Modéliser l’erreur comme la combinaison d’une erreur individuelle fixe et d’une erreur temporelle <span class="math inline">\(\Rightarrow\)</span> modèle à effet aléatoire (<em>random effect</em>).</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="mod-id2.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Là il y a une flopée de méthodes possibles pour corriger les écart-types, mais la manière la plus simple est d&#39;utiliser directement la fonction felm()</span></span>
<span id="cb27-2"><a href="mod-id2.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilise felm(), jdcjdr.</span></span>
<span id="cb27-3"><a href="mod-id2.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span> var_cluster_se, data)</span></code></pre></div>
</div>
<div id="les-modèles-à-effet-aléatoire" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Les modèles à effet aléatoire</h3>
<p>On estime le modèle suivant:
<span class="math display">\[y_{it} = \beta_0 + \beta_i x_{it} + \alpha_i + \epsilon_{it}\]</span></p>
<ul>
<li>Deux termes aléatoires <span class="math inline">\(\alpha_i\)</span> et <span class="math inline">\(\epsilon_{it}\)</span> qui ont chacun une loi de distribution propre.</li>
<li>La technique d’estimation est celle des moindres carrés généralisés.</li>
<li>L’avantage de ce modèle est de permettre une décomposition de la variance des résidus en un facteur individuel (i.e. <em>between</em>, et le cas échéant un facteur temporel) et un facteur idiosyncrasique [big words].</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="mod-id2.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, data, index, <span class="at">model =</span> <span class="st">&quot;random&quot;</span>)</span></code></pre></div>
</div>
<div id="le-problème-dhétérogénéité-inobservée" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Le problème d’hétérogénéité inobservée</h3>
<p>Modèle à effet aléatoire :
<span class="math display">\[y_{it} = \beta_0 + \beta_i x_{it} + \alpha_i + \epsilon_{it}\]</span></p>
<ul>
<li>Si <span class="math inline">\(cov(x_{kit},\alpha_i) = 0\)</span>, RAS.</li>
<li>Mais l’erreur individuelle <span class="math inline">\(\alpha_i\)</span> peut être vue comme le produit de l’ensemble des variables inobservables invariantes dans le temps. Il n’est pas impossible que ces variables inobservables soient corrélées avec les observables.</li>
<li>Plutôt que de modéliser les <span class="math inline">\(\alpha_i\)</span> par un effet aléatoire, on peut les modéliser par un effet fixe.</li>
</ul>
<div id="modèle-à-effets-fixes-fixed-effects" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Modèle à effets fixes (<em>fixed effects</em>)</h4>
<ul>
<li>Moindre carré à variables dichotomiques : <em>Least square dummy variables</em> ou LSDV. Introduire une variable dichotomique <span class="math inline">\(\alpha_i\)</span> par individu, possible uniquement si le nombre d’individus est petit (&lt;1000).</li>
<li>Modèle “<em>within</em>”* : modèle (sans constante) où l’on centre chaque variable (explicative ou expliquée), càd où l’on calcule l’écart à la moyenne de la variable pour l’individu.</li>
</ul>
<p><span class="math display">\[(y_{it} - \bar y_i) = \beta_i (x_{it} - \bar x_i) + (\epsilon_{it} - \bar \epsilon_i)\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="mod-id2.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec les effets fixes ##</span></span>
<span id="cb29-2"><a href="mod-id2.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">factor</span>(var_indiv)<span class="sc">+</span>x1<span class="sc">+</span>x2, data)</span>
<span id="cb29-3"><a href="mod-id2.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="mod-id2.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec l&#39;estimateur within et le pkg plm ##</span></span>
<span id="cb29-5"><a href="mod-id2.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, index, <span class="at">model =</span> <span class="st">&quot;within&quot;</span>, data)</span>
<span id="cb29-6"><a href="mod-id2.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="mod-id2.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec l&#39;estimateur within et le pkg lfe ##</span></span>
<span id="cb29-8"><a href="mod-id2.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> var_indiv, data)</span>
<span id="cb29-9"><a href="mod-id2.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># en clusterisant les erreurs types par individu</span></span>
<span id="cb29-10"><a href="mod-id2.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> var_indiv <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span> var_indiv, data)</span></code></pre></div>
<p><strong>Deux effets fixes: groupes et temps</strong></p>
<p>On peut introduire un effet fixe par unité de groupe (e.g. individu, pays, etc.) et un effet fixe par unité de temps.</p>
<p>La conjoncture commune capturée par l’effet fixe temps:</p>
<ul>
<li>Tout avec des variables dichotomiques<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>:</li>
</ul>
<p><span class="math display">\[y_{it}=\beta_i X_{it} + \alpha_i + \delta_t + \epsilon_{it}\]</span></p>
<ul>
<li><em>Within</em> + variables dichotomiques de temps.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="mod-id2.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">factor</span>(var_temps), index, <span class="at">model=</span><span class="st">&quot;within&quot;</span>, data)</span></code></pre></div>
<ul>
<li><em>Two ways within</em> (formule pour panel cylindrés)</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="mod-id2.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, index, <span class="at">model=</span><span class="st">&quot;within&quot;</span>, <span class="at">effect=</span><span class="st">&quot;twoways&quot;</span>, data) <span class="co"># très lent</span></span></code></pre></div>
</div>
<div id="modèles-en-différences-premières-first-difference" class="section level4" number="4.3.3.2">
<h4><span class="header-section-number">4.3.3.2</span> Modèles en différences premières (<em>first difference</em>)</h4>
<p>Expliquer les évolutions par les évolutions (e.g différence revenu entre 1 année, puis 2, puis 5, etc…)
<span class="math display">\[ (y_{it} - y_{it-1})=\beta_i (x_{it} - x_{it-1}) + (\epsilon_{it} - \epsilon_{it-1})\]</span>
Le choix du retard:</p>
<ul>
<li><span class="math inline">\([t,t-1] \rightarrow\)</span> on se focalise sur des variations de court terme,</li>
<li><span class="math inline">\([t,t-k] \rightarrow\)</span> variations de plus long terme, mais perte d’effectifs et de puissance.</li>
</ul>
<p>Différence entre effets fixes &amp; différences premières:</p>
<ul>
<li>panel à deux périodes: modèles équivalents (uniquement lorsque le modèle <em>within</em> comporte aussi un effet fixe temps).</li>
<li>panel à plusieurs périodes: le modèle à effets fixes est une moyenne de variations de courtes et de longues périodes.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="mod-id2.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, index, <span class="at">model =</span> <span class="st">&quot;fd&quot;</span>, data)</span></code></pre></div>
</div>
</div>
<div id="se-concentrer-sur-la-variance-interindividuelle-et-éliminer-la-variance-intra-individuelle" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Se concentrer sur la variance interindividuelle et éliminer la variance intra-individuelle</h3>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>Différent du modèle <em>théorique</em>.<a href="mod-id2.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>A éviter car prend beaucoup de place et de mémoire sur la console R.<a href="mod-id2.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="log-lin.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="an-long.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pyrrhamide/regressions/blob/main/06_approche_exp.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
