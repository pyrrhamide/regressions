<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Mod√©lisation et identification causale, vol.¬†2 | Toutes les m√©thodes du master</title>
  <meta name="description" content="4 Mod√©lisation et identification causale, vol.¬†2 | Toutes les m√©thodes du master" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Mod√©lisation et identification causale, vol.¬†2 | Toutes les m√©thodes du master" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="pyrrhamide/regressions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Mod√©lisation et identification causale, vol.¬†2 | Toutes les m√©thodes du master" />
  
  
  

<meta name="author" content="KF" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="log-lin.html"/>
<link rel="next" href="an-long.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">M√©thodes du master</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Pr√©sentation</a></li>
<li class="part"><span><b>I D√©marrage</b></span></li>
<li class="chapter" data-level="" data-path="stat-desc.html"><a href="stat-desc.html"><i class="fa fa-check"></i>Statistiques descriptives</a></li>
<li class="chapter" data-level="" data-path="nettoyage.html"><a href="nettoyage.html"><i class="fa fa-check"></i>Nettoyage des donn√©es</a></li>
<li class="part"><span><b>II M√©thodes de r√©gressions</b></span></li>
<li class="chapter" data-level="1" data-path="reg-lin.html"><a href="reg-lin.html"><i class="fa fa-check"></i><b>1</b> R√©gressions lin√©aires</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reg-lin.html"><a href="reg-lin.html#moindres-carr√©s-ordinaires---hypoth√®ses"><i class="fa fa-check"></i><b>1.1</b> Moindres Carr√©s Ordinaires - hypoth√®ses</a></li>
<li class="chapter" data-level="1.2" data-path="reg-lin.html"><a href="reg-lin.html#r√©gressions-lin√©aires-simple-et-multiple"><i class="fa fa-check"></i><b>1.2</b> R√©gressions lin√©aires simple et multiple</a></li>
<li class="chapter" data-level="1.3" data-path="reg-lin.html"><a href="reg-lin.html#r√©gression-lin√©aire-de-probabilit√©"><i class="fa fa-check"></i><b>1.3</b> R√©gression lin√©aire de probabilit√©</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reg-log.html"><a href="reg-log.html"><i class="fa fa-check"></i><b>2</b> R√©gressions logistiques</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reg-log.html"><a href="reg-log.html#r√©gression-logistique-dichotomique"><i class="fa fa-check"></i><b>2.1</b> R√©gression logistique dichotomique</a></li>
<li class="chapter" data-level="2.2" data-path="reg-log.html"><a href="reg-log.html#r√©gression-logistique-polytomique"><i class="fa fa-check"></i><b>2.2</b> R√©gression logistique polytomique</a></li>
<li class="chapter" data-level="2.3" data-path="reg-log.html"><a href="reg-log.html#odds-ratio-complet"><i class="fa fa-check"></i><b>2.3</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="log-lin.html"><a href="log-lin.html"><i class="fa fa-check"></i><b>3</b> R√©gression log-lin√©aire</a>
<ul>
<li class="chapter" data-level="3.1" data-path="log-lin.html"><a href="log-lin.html#mod√®le-de-lind√©pendance"><i class="fa fa-check"></i><b>3.1</b> Mod√®le de l‚Äôind√©pendance</a></li>
<li class="chapter" data-level="3.2" data-path="log-lin.html"><a href="log-lin.html#mod√®les-avec-interaction"><i class="fa fa-check"></i><b>3.2</b> Mod√®les avec interaction</a></li>
<li class="chapter" data-level="3.3" data-path="log-lin.html"><a href="log-lin.html#analyse-de-deviance"><i class="fa fa-check"></i><b>3.3</b> Analyse de deviance</a></li>
<li class="chapter" data-level="3.4" data-path="log-lin.html"><a href="log-lin.html#odds-ratio"><i class="fa fa-check"></i><b>3.4</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-id2.html"><a href="mod-id2.html"><i class="fa fa-check"></i><b>4</b> Mod√©lisation et identification causale, vol.¬†2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-id2.html"><a href="mod-id2.html#approches-exp√©rimentales"><i class="fa fa-check"></i><b>4.1</b> Approches exp√©rimentales</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="mod-id2.html"><a href="mod-id2.html#exp√©riences-al√©atoires-contr√¥l√©es"><i class="fa fa-check"></i><b>4.1.1</b> Exp√©riences al√©atoires contr√¥l√©es</a></li>
<li class="chapter" data-level="4.1.2" data-path="mod-id2.html"><a href="mod-id2.html#exp√©riences-naturelles"><i class="fa fa-check"></i><b>4.1.2</b> Exp√©riences naturelles</a></li>
<li class="chapter" data-level="4.1.3" data-path="mod-id2.html"><a href="mod-id2.html#diff√©rences-de-diff√©rences-differences-in-differences"><i class="fa fa-check"></i><b>4.1.3</b> Diff√©rences-de-diff√©rences (<em>differences-in-differences</em>)</a></li>
<li class="chapter" data-level="4.1.4" data-path="mod-id2.html"><a href="mod-id2.html#r√©gression-par-discontinuit√©-regression-discontinuity-design"><i class="fa fa-check"></i><b>4.1.4</b> R√©gression par discontinuit√© (<em>Regression discontinuity design</em>)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mod-id2.html"><a href="mod-id2.html#variables-instrumentales"><i class="fa fa-check"></i><b>4.2</b> Variables instrumentales</a></li>
<li class="chapter" data-level="4.3" data-path="mod-id2.html"><a href="mod-id2.html#econom√©trie-des-panels"><i class="fa fa-check"></i><b>4.3</b> Econom√©trie des panels</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="mod-id2.html"><a href="mod-id2.html#le-mod√®le-homog√®ne-ou-pooled"><i class="fa fa-check"></i><b>4.3.1</b> Le mod√®le homog√®ne, ou <em>pooled</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="mod-id2.html"><a href="mod-id2.html#les-mod√®les-√†-effet-al√©atoire"><i class="fa fa-check"></i><b>4.3.2</b> Les mod√®les √† effet al√©atoire</a></li>
<li class="chapter" data-level="4.3.3" data-path="mod-id2.html"><a href="mod-id2.html#le-probl√®me-dh√©t√©rog√©n√©it√©-inobserv√©e"><i class="fa fa-check"></i><b>4.3.3</b> Le probl√®me d‚Äôh√©t√©rog√©n√©it√© inobserv√©e</a></li>
<li class="chapter" data-level="4.3.4" data-path="mod-id2.html"><a href="mod-id2.html#se-concentrer-sur-la-variance-interindividuelle-et-√©liminer-la-variance-intra-individuelle"><i class="fa fa-check"></i><b>4.3.4</b> Se concentrer sur la variance interindividuelle et √©liminer la variance intra-individuelle</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="an-long.html"><a href="an-long.html"><i class="fa fa-check"></i><b>5</b> Analyses longitudinales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="an-long.html"><a href="an-long.html#pseudo-panels"><i class="fa fa-check"></i><b>5.1</b> Pseudo-panels</a></li>
<li class="chapter" data-level="5.2" data-path="an-long.html"><a href="an-long.html#mod√®les-lin√©aires"><i class="fa fa-check"></i><b>5.2</b> Mod√®les lin√©aires</a></li>
<li class="chapter" data-level="5.3" data-path="an-long.html"><a href="an-long.html#mod√®les-dynamiques"><i class="fa fa-check"></i><b>5.3</b> Mod√®les dynamiques</a></li>
<li class="chapter" data-level="5.4" data-path="an-long.html"><a href="an-long.html#mod√®les-non-lin√©aires"><i class="fa fa-check"></i><b>5.4</b> Mod√®les non-lin√©aires</a></li>
<li class="chapter" data-level="5.5" data-path="an-long.html"><a href="an-long.html#mod√®les-de-dur√©e"><i class="fa fa-check"></i><b>5.5</b> Mod√®les de dur√©e</a></li>
<li class="chapter" data-level="5.6" data-path="an-long.html"><a href="an-long.html#optimal-matching"><i class="fa fa-check"></i><b>5.6</b> Optimal matching</a></li>
</ul></li>
<li class="part"><span><b>III Autres m√©thodes</b></span></li>
<li class="chapter" data-level="6" data-path="an-res.html"><a href="an-res.html"><i class="fa fa-check"></i><b>6</b> Analyses de r√©seaux</a>
<ul>
<li class="chapter" data-level="6.1" data-path="an-res.html"><a href="an-res.html#bases-de-la-th√©orie"><i class="fa fa-check"></i><b>6.1</b> Bases de la th√©orie</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="an-res.html"><a href="an-res.html#matrices"><i class="fa fa-check"></i><b>6.1.1</b> Matrices</a></li>
<li class="chapter" data-level="6.1.2" data-path="an-res.html"><a href="an-res.html#liens"><i class="fa fa-check"></i><b>6.1.2</b> Liens</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="an-res.html"><a href="an-res.html#structures-locales"><i class="fa fa-check"></i><b>6.2</b> Structures locales</a></li>
<li class="chapter" data-level="6.3" data-path="an-res.html"><a href="an-res.html#connectivit√©"><i class="fa fa-check"></i><b>6.3</b> Connectivit√©</a></li>
<li class="chapter" data-level="6.4" data-path="an-res.html"><a href="an-res.html#mesures-basiques-de-coh√©sion"><i class="fa fa-check"></i><b>6.4</b> Mesures basiques de coh√©sion</a></li>
<li class="chapter" data-level="6.5" data-path="an-res.html"><a href="an-res.html#mesures-de-diversit√©"><i class="fa fa-check"></i><b>6.5</b> Mesures de diversit√©</a></li>
<li class="chapter" data-level="6.6" data-path="an-res.html"><a href="an-res.html#mesures-de-centralit√©"><i class="fa fa-check"></i><b>6.6</b> Mesures de centralit√©</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Toutes les m√©thodes du master</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-id2" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Mod√©lisation et identification causale, vol.¬†2</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="mod-id2.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lfe)</span>
<span id="cb22-2"><a href="mod-id2.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb22-3"><a href="mod-id2.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb22-4"><a href="mod-id2.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb22-5"><a href="mod-id2.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<p>Je mets imm√©diatement les lignes de codes compl√®tes ici. Il est fortement recommand√© d‚Äôutiliser la fonction <code>felm()</code> du package <code>lfe</code> pour toutes les techniques de ce cours, mais il est aussi possible d‚Äôutiliser <code>lm()</code>, <code>plm()</code> ou <code>ivreg()</code> pour de petites v√©rifications.</p>
<p>La fonction <code>felm()</code> fait tout: les effets fixes, les effets al√©atoires, les variables instrumentales, la clusterisation des erreurs-types‚Ä¶it‚Äôs the GOAT üêê.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="mod-id2.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## La syntaxe des commandes principales ##</span></span>
<span id="cb23-2"><a href="mod-id2.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> f1 <span class="sc">+</span> f2 <span class="sc">|</span> x3 <span class="sc">+</span> x4 <span class="sc">|</span> clu1 <span class="sc">+</span> clu2, data, weights, ...)</span>
<span id="cb23-3"><a href="mod-id2.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soit</span></span>
<span id="cb23-4"><a href="mod-id2.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(var_dep <span class="sc">~</span> vars_indep <span class="sc">|</span> vars_effet_fixe <span class="sc">|</span> vars_instrumentales <span class="sc">|</span> vars_cluster_se, data, weights, ...)</span>
<span id="cb23-5"><a href="mod-id2.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># si on veut seulement clusteriser les erreurs-types, on remplace</span></span>
<span id="cb23-6"><a href="mod-id2.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vars_effet_fixe et/ou vars_instrumentales par 0</span></span>
<span id="cb23-7"><a href="mod-id2.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1<span class="sc">+</span>x2 <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>clu1<span class="sc">+</span>clu2, data, weights, ...)</span>
<span id="cb23-8"><a href="mod-id2.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="mod-id2.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les variables instrumentales - plus d√©taill√© plus tard</span></span>
<span id="cb23-10"><a href="mod-id2.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb23-11"><a href="mod-id2.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># soit</span></span>
<span id="cb23-12"><a href="mod-id2.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(var_dep <span class="sc">~</span> var_endo <span class="sc">+</span> vars_indep <span class="sc">|</span> vars_exo_inst, data, weights, ...)</span>
<span id="cb23-13"><a href="mod-id2.html#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="mod-id2.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les donn√©es de panel/effets fixes et tout √ßa</span></span>
<span id="cb23-15"><a href="mod-id2.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;var_indiv&quot;</span>,<span class="st">&quot;var_temps&quot;</span>), data, <span class="at">model =</span> <span class="st">&quot;pooling&quot;</span>)</span>
<span id="cb23-16"><a href="mod-id2.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># voir la documentation pour les autres &quot;model&quot; et √©galement les &quot;effect&quot;.</span></span></code></pre></div>
<div id="approches-exp√©rimentales" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Approches exp√©rimentales</h2>
<p>Groupe trait√© v groupe de contr√¥le.</p>
<p>Pour conna√Ætre l‚Äôeffet du traitement, groupe ‚Äòtrait√©‚Äô diff√®re du groupe de contr√¥le seulement du traitement.</p>
<p>4 m√©thodes autour de cette id√©e:</p>
<ol style="list-style-type: decimal">
<li>Exp√©riences al√©atoires contr√¥l√©es</li>
<li>Exp√©riences naturelles</li>
<li>Diff√©rences de diff√©rences</li>
<li>R√©gression par discontinuit√©</li>
</ol>
<div id="exp√©riences-al√©atoires-contr√¥l√©es" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Exp√©riences al√©atoires contr√¥l√©es</h3>
<p>2 exemples d‚Äôexp√©riences al√©atoires contr√¥l√©es:</p>
<ul>
<li>Exp√©rience √† essais randomis√©s contr√¥l√©s (<em>randomised controlled trials (RCT) experiments</em>)</li>
<li>Exp√©riences par questionnaire (<em>randomised survey experiment</em>)</li>
</ul>
<p>On prend un groupe qui rempli les m√™mes caract√©ristiques (du type la promo du M2) √† qui on applique un ou des traitements diff√©rents pour voir si les r√©sultats sur une variable √† expliquer diff√®rent.</p>
<p>Il y a deux directrices. On est all√©s voir l‚Äôune ou l‚Äôautre l‚Äôann√©e derni√®re (dans le contexte de l‚Äôexp√©rience al√©atoire, disons qu‚Äôon les a choisi al√©atoirement) et c‚Äôest celle qu‚Äôon a vu qui est devenue notre interlocutrice principale (c‚Äôest la ventilation al√©atoire il me semble). Du coup, au sein de la promo (normalement uniforme mais tmtc que nan), on est soumis √† un traitement diff√©rent selon la dir. Y a-t-il une diff√©rence de notes/de moral en fonction de la personne ?</p>
<p>Dans cette situation que je viens de d√©crire, il devrait normalement y avoir un troisi√®me groupe (groupe de contr√¥le - ind√©pendance du traitement) sans interlocutrice.</p>
<p><strong>Pourquoi l‚Äôexp√©rience randomis√©e ?</strong></p>
<ul>
<li>Ventilation al√©atoire assure que toutes les caract√©ristiques des individus (√† la fois observ√©es et surtout inobserv√©es) vont √™tre ventil√©es de mani√®re √©quiprobable dans les groupes trait√©s ou de contr√¥le.</li>
<li>L‚Äôestimation n‚Äôest plus biais√©e par une variable confondante (h√©t√©rog√©n√©it√© inobserv√©e)</li>
<li>Simplification consid√©rable de la statistique
<ul>
<li>intensit√© indiqu√©e par la diff√©rence (ou le rapport) des moyennes</li>
<li>significativit√© test de diff√©rence de moyennes ou de proportions [pr√©ciser le.s tests en question]</li>
</ul></li>
<li>Exp√©rience al√©atoire versus √©chantillon al√©atoire
<ul>
<li>√©chantillon al√©atoire: √©tablir des statistiques repr√©sentatives d‚Äôune population <span class="math inline">\(\rightarrow\)</span> validit√© externe [d√©finir ce que c‚Äôest].</li>
<li>exp√©rience al√©atoire: ventilation al√©atoire d‚Äôun √©chantillon <span class="math inline">\(\rightarrow\)</span> validit√© interne [d√©finir].</li>
</ul></li>
</ul>
<p><strong>L‚Äôexp√©rience et ses aveugles</strong></p>
<ul>
<li>Simple aveugle: le patient ne sait pas dans quel groupe il est (trait√© ou placebo)</li>
<li>Double aveugle: le patient et la personne qui administre le traitement ne savent pas dans quel groupe se trouve le patient</li>
<li>Triple aveugle: le patient, la personne qui administre le traitement et le statisticien ne savent pas dans quel groupe se trouve le patient.</li>
</ul>
<p>L‚Äôexp√©rience al√©atoire en sciences sociales est rarement une exp√©rience avec placebo et en aveugle. Le placebo, qui doit avoir la forme, le go√ªt, etc. du placebo, n‚Äôexiste pas toujours [trouver exemple]. Il y a souvent 2 groupes: un qui fait l‚Äôobjet d‚Äôune intervention et un qui ne re√ßoit rien. Il importe alors d‚Äô√™tre vigilent √† faire une analyse en intention de traiter (<em>intention to treat</em>) plut√¥t que traitement r√©alis√© (<em>treatment on treated</em>).</p>
<p>[parler des limites techniques et conceptuelles?]</p>
</div>
<div id="exp√©riences-naturelles" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Exp√©riences naturelles</h3>
<ul>
<li>Situation ‚Äúnaturelle‚Äù qui ressemble √† une situation exp√©rimentale (ventilation al√©atoire ou quasi-al√©atoire d‚Äôune population entre groupe trait√© et groupe de contr√¥le) sans avoir √©t√© construite √† des fins exp√©rimentales.</li>
<li>Tirages au sort comme proc√©dure d‚Äôallocation (e.g.¬†jur√©s en tribunal, distribution dans les chambres d‚Äôinternat, r√©partition entre ceux qui ont d√ª pr√©senter leur probl√©matique de m√©moire le jour 1 et le jour 2)</li>
<li>Autres exemples : jeux al√©atoires et loteries, ph√©nom√®ne al√©atoires ou quasi al√©atoires (sexe de l‚Äôenfant/mois de naissance), recrutement acad√©mique‚Ä¶</li>
</ul>
<p>[EXEMPLE!!!]</p>
</div>
<div id="diff√©rences-de-diff√©rences-differences-in-differences" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Diff√©rences-de-diff√©rences (<em>differences-in-differences</em>)</h3>
<p>On reprend l‚Äôopposition groupe trait√© versus groupe de contr√¥le des exp√©riences contr√¥l√©es. Toutefois, on n‚Äôest pas s√ªr que les groupes de contr√¥les soient vraiment similaires en tout point except√© le traitement. On va faire une hypoth√®se plus faible: la diff√©rence entre traitement et contr√¥le est constante dans le temps.</p>
<ul>
<li>diff√©rence pr√©traitement est la diff√©rence li√©e aux ‚Äúinobservables‚Äù</li>
<li>diff√©rence post-traitement est la diff√©rence li√©e aux ‚Äúinobservables‚Äù + effet causal</li>
<li>diff√©rence de diff√©rence est l‚Äôeffet causal (diff post - diff pr√©)</li>
</ul>
<p>Diff√©rence ‚Äústandard‚Äù :
<span class="math display">\[Trait√© - Contr√¥le \\ T_1 - C_1\]</span>
Diff√©rence de diff√©rence est l‚Äôestimation :
<span class="math display">\[DiD = (Trait√©_{post}-Trait√©_{ant√©})-(Contr√¥le_{post}-Contr√¥le_{ant√©}) \\ DiD = (T_1-T_0)-(C_1-C_0)\]</span></p>
<p>Notations classiques :<br />
- <span class="math inline">\(T_1=\mu_{11}\)</span> ; <span class="math inline">\(T_0=\mu_{10}\)</span> ; <span class="math inline">\(C_1=\mu_{01}\)</span> ; <span class="math inline">\(C_0=\mu_{00}\)</span><br />
- Diff-in-Diff = <span class="math inline">\((\mu_{11}-\mu_{01})-(\mu_{10}-\mu_{00})\)</span></p>
<p><strong>Estimations √©conom√©triques</strong><br />
Quand on a un panel :<br />
- on mesure sur les m√™mes individus, l‚Äôavant et l‚Äôapr√®s,<br />
- on estime l‚Äô√©volution,<br />
- <span class="math inline">\(\Delta y_i = \beta_0 + \beta_1 GT + \epsilon_i\)</span> ou GT est le groupe trait√©,<br />
- <span class="math inline">\(\Delta y_i\)</span> est l‚Äô√©volution/la variation de <span class="math inline">\(y_i\)</span>
- <span class="math inline">\(\beta_0\)</span> est l‚Äôintercept [nom sp√©cial en DiD?]
- <span class="math inline">\(\beta_1\)</span> est l‚Äôestimateur DiD.
- <span class="math inline">\(\epsilon_i\)</span> est le terme d‚Äôerreur [distribution sp√©ciale?]</p>
<p>Quand on n‚Äôa pas de panel :<br />
- les individus avant et apr√®s ne sont pas les m√™mes,<br />
- <span class="math inline">\(y_{it} = \beta_0 + \beta_1 GT + \beta_2 t + \beta_3 t \times GT + \epsilon_{it}\)</span>,<br />
- <span class="math inline">\(\beta_3\)</span> est l‚Äôestimateur DiD.</p>
<p><strong>Port√©es et limites</strong></p>
<ul>
<li>Hypoth√®ses fortes:
<ul>
<li>la diff√©rence entre le traitement et le contr√¥le serait rest√©e constante en l‚Äôabsence de traitement.</li>
<li>ou redit autrement, la diff√©rence de diff√©rence est unniquement due au ‚Äútraitement‚Äù et non √† un autre changement intervenu dans le groupe trait√© entre la p√©riode 1 et 2.</li>
</ul></li>
<li>Si on dispose de plus de deux p√©riodes, on peut faire une v√©rification graphique.</li>
</ul>
</div>
<div id="r√©gression-par-discontinuit√©-regression-discontinuity-design" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> R√©gression par discontinuit√© (<em>Regression discontinuity design</em>)</h3>
<p>Les groupes sont ventil√©s pour recevoir ou non un traitement en fonction d‚Äôun seuil sur une variable mesurable (continue). Par exemple, les personnes qui sont arr√™t√©es au-del√† d‚Äôun seuil d‚Äôalcool dans le sang ont l‚Äôobligation de suivre un traitement, et les groupes au-dessous de ce seuil servent de groupe de comparaison (groupe de contr√¥le). L‚Äôeffet est mesur√© au niveau de la discontinuit√© entre le groupe trait√© et le groupe de contr√¥le (on ne fait pas la diff√©rence de moyenne entre deux groupes).</p>
<p><strong>Conditions d‚Äôapplications</strong></p>
<p>Le seuil est exog√®ne, non manipulable, et d√©clenche les actions:</p>
<ul>
<li>majorit√© absolue <span class="math inline">\(\rightarrow\)</span> effet de l‚Äô√©lection</li>
<li>rang du dernier poste offert au concours <span class="math inline">\(\rightarrow\)</span> effet de l‚Äô√©cole</li>
<li>seuil de d√©clenchement d‚Äôune mesure sociale ou fiscale <span class="math inline">\(\rightarrow\)</span> effet de la politique, etc‚Ä¶</li>
</ul>
<p><strong>Avantages et d√©savantages</strong></p>
<p>Avantages: quand c‚Äôest bien effectu√©, la r√©gression par discontinuit√© permet une estimation non biais√©e du traitement.</p>
<p>D√©savantages:</p>
<ul>
<li>la puissance statistique est bien moindre que dans des essais randomis√©s contr√¥l√©s portant sur le m√™me effectif. L‚Äôattention √† la puissance statistique est cruciale.</li>
<li>les effets sont sans biais uniquement si la forme fonctionnelle entre la variable d‚Äôassignation et la variable de r√©sultat est bien mod√©lis√©e, y compris:
<ul>
<li>des relations non-lin√©aires (augmentation - plateau - augmentation)</li>
<li>des interactions (pente coef 1 - seuil - pente coef 2)</li>
</ul></li>
</ul>
<p><strong>Estimations √©conom√©triques</strong><br />
Le mod√®le lin√©aire simple (premi√®res estimations)<br />
- <span class="math inline">\(y_i = \beta_0 + \beta_1 x + \beta_2 (x&gt;seuil) + \epsilon_i\)</span>,<br />
- L‚Äôeffet causal est mesur√© par <span class="math inline">\(\beta_2\)</span>,<br />
- Limite suppose que la forme fonctionnelle est la m√™me de part et d‚Äôautre du seuil (en gros, que le coefficient de la pente soit pas trop diff√©rent √† gauche et √† droite de la discontinuit√©).</p>
<p>Le mod√®le lin√©aire avec changement de pente<br />
- <span class="math inline">\(y_i = \beta_0 + \beta_1 x + \beta_2 (x&gt;seuil) + \beta_3x \times (x&gt;seuil) + \epsilon_i\)</span><br />
- l‚Äôeffet causal est mesur√© par <span class="math inline">\(\beta_2\)</span>.
- diff√©rence avec mod√®le lin√©aire simple: on interagit <span class="math inline">\(x\)</span> pr√©-seuil et post-seuil.</p>
<p>Le mod√®le lin√©aire avec changement de forme<br />
- attention de bien centrer la variable <span class="math inline">\(x\)</span> autour du seuil ! <span class="math inline">\(x&#39; = x-seuil\)</span>,<br />
- <span class="math inline">\(y_i = \beta_0 + \beta_1 x&#39; + \beta_2 x^{&#39;2} + \beta_3(x&#39;&gt;0) + \beta_4x&#39; \times (x&#39;&gt;0) + \beta_5 x^{&#39;2} \times (x&#39;&gt;0) + \epsilon_i\)</span>,<br />
- l‚Äôeffet causal est mesur√© par <span class="math inline">\(\beta_3\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="mod-id2.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression discontinuity design - je recommende de regarder directement le code du prof et de lancer les commandes.</span></span>
<span id="cb24-2"><a href="mod-id2.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="mod-id2.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># recentrage de la variable autour du seuil</span></span>
<span id="cb24-4"><a href="mod-id2.html#cb24-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>var_cont_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>var_continue <span class="sc">-</span> valeur_seuil_au_choix <span class="co"># commande parmi plein d&#39;autres, l√† c&#39;est toi qui prend l&#39;initiative</span></span>
<span id="cb24-5"><a href="mod-id2.html#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="mod-id2.html#cb24-6" aria-hidden="true" tabindex="-1"></a>pr1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_continue<span class="sc">+</span><span class="fu">I</span>(var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix),<span class="at">data=</span>d)</span>
<span id="cb24-7"><a href="mod-id2.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># suppose que pente est la m√™me √† gauche et √† droite du seuil</span></span>
<span id="cb24-8"><a href="mod-id2.html#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="mod-id2.html#cb24-9" aria-hidden="true" tabindex="-1"></a>pr1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_cont_cent<span class="sc">+</span><span class="fu">I</span>(var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>),<span class="at">data=</span>d)</span>
<span id="cb24-10"><a href="mod-id2.html#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="mod-id2.html#cb24-11" aria-hidden="true" tabindex="-1"></a>pr2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_continue<span class="sc">+</span><span class="fu">I</span>(var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">+</span></span>
<span id="cb24-12"><a href="mod-id2.html#cb24-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">I</span>((var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">*</span>var_continue),<span class="at">data=</span>d)</span>
<span id="cb24-13"><a href="mod-id2.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="mod-id2.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># pour cacher les points extr√™mes de la base (pour garder la lin√©arit√©)</span></span>
<span id="cb24-15"><a href="mod-id2.html#cb24-15" aria-hidden="true" tabindex="-1"></a>pr2b <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_continue<span class="sc">+</span><span class="fu">I</span>(var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">+</span></span>
<span id="cb24-16"><a href="mod-id2.html#cb24-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>((var_continue<span class="sc">&gt;=</span>valeur_seuil_au_choix)<span class="sc">*</span>var_continue),</span>
<span id="cb24-17"><a href="mod-id2.html#cb24-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>d[d<span class="sc">$</span>var_continue<span class="sc">&gt;=</span>valeur1 <span class="sc">&amp;</span> d<span class="sc">$</span>var_continue<span class="sc">&lt;=</span>valeur2,])</span>
<span id="cb24-18"><a href="mod-id2.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># pr2 et pr2b supposent que l&#39;effet est lin√©aire des deux cot√©s du seuil</span></span>
<span id="cb24-19"><a href="mod-id2.html#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="mod-id2.html#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="mod-id2.html#cb24-21" aria-hidden="true" tabindex="-1"></a>pr3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(var_dep <span class="sc">~</span> var_cont_cent<span class="sc">+</span></span>
<span id="cb24-22"><a href="mod-id2.html#cb24-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>(var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb24-23"><a href="mod-id2.html#cb24-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>((var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">*</span>var_cont_cent)<span class="sc">+</span></span>
<span id="cb24-24"><a href="mod-id2.html#cb24-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>((var_cont_cent<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">*</span>var_cont_cent2),<span class="at">data=</span>d)</span></code></pre></div>
</div>
</div>
<div id="variables-instrumentales" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Variables instrumentales</h2>
<p>Violation de la 6√®me hypoth√®se des MCO (<span class="math inline">\(Cov(x_i,\epsilon_i \neq 0)\)</span> absence de corr√©lation entre les variables explicatives et le r√©sidu) <span class="math inline">\(\Rightarrow\)</span> <em>endog√©n√©it√©</em>. Pb endog√©n√©it√© peut conduire √† se tromper dans l‚Äôinterpr√©tation des param√®tres. Variables instrumentales comme technique de correction.</p>
<p>3 probl√®mes et leurs effets sur les param√®tres:</p>
<ul>
<li>Erreur de mesure d‚Äôune variable explicative: sous-estimation de la valeur absolue du param√®tre <span class="math inline">\(\beta_i\)</span>.</li>
<li>Variable omise ou h√©t√©rog√©n√©it√© inobserv√©e (corr√©l√©e √† la variable d√©pendante et √† une autre variable explicative): sur/sous-estimation de la valeur absolue du param√®tre.</li>
<li>Simultan√©it√© (variable explicative d√©pend de la variable expliqu√©e): effet plus complexe. Pas d‚Äôintuition √©vidente.</li>
</ul>
<p>Solution <span class="math inline">\(\Rightarrow\)</span> variable instrumentale: trouver une variable instrumentale exog√®ne qui impacte ma variable expliqu√©e <span class="math inline">\(y_i\)</span> uniquement par l‚Äôinterm√©diaire de son effet sur la variable explicative <span class="math inline">\(x_i\)</span> suspecte d‚Äôendog√©n√©it√©.
<span class="math display">\[ instrument \rightarrow var\_endo \rightarrow var\_dep\]</span></p>
<p>Sachant que <span class="math inline">\(cov(x_{endo},\epsilon) \neq 0\)</span>, on introduit une variable instrumentale (<span class="math inline">\(z_{inst}\)</span>) telle que:</p>
<ul>
<li><span class="math inline">\(cov(z_{inst},x_{endo}) \neq 0\)</span>, et</li>
<li><span class="math inline">\(cov(z_{inst},\epsilon) = 0\)</span></li>
</ul>
<p>Vrai mod√®le<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>: <span class="math inline">\(y = a_{vrai} + b_{vrai} x_{endo} + c_{vrai} x_2 + \epsilon\)</span> avec <span class="math inline">\(cov(x_{endo},\epsilon) \neq 0\)</span>.</p>
<p><strong>Premi√®re √©tape</strong>: on r√©gresse la variable endog√®ne √† la fois sur l‚Äôinstrument et sur les autres variables explicatives. NB: on met toutes les variables explicatives m√™me non pertinentes en premi√®re √©tape.
<span class="math display">\[x_{endo} = a_0 + a_1 z_{inst} + a_2 x_2 + \epsilon_{prem}\]</span></p>
<p>On r√©cup√®re de cette premi√®re r√©gression <span class="math inline">\(x&#39;_{endo}\)</span>, la pr√©diction de la variable endog√®ne <span class="math inline">\(x_{endo}\)</span>:
<span class="math display">\[x&#39;_{endo} = a_0 + a_1 z_{inst} + a_2 x_2 = x_{endo} - \epsilon_{prem}\]</span></p>
<p><strong>Deuxi√®me √©tape</strong>: on introduit cette pr√©diction dans la r√©gression √† la place <span class="math inline">\(x_{endo}\)</span>.
<span class="math display">\[y = a_{est} + b_{est} x&#39;_{endo} + c_{est} x_2 + \epsilon_{deux}\]</span></p>
<p>Comme <span class="math inline">\(z_{inst}\)</span> et <span class="math inline">\(x_2\)</span> ne sont pas corr√©l√©s avec le r√©sidu <span class="math inline">\(\epsilon\)</span>, alors <span class="math inline">\(x&#39;_{endo}\)</span> n‚Äôest plus corr√©l√© avec <span class="math inline">\(\epsilon\)</span>, l‚Äôestimateur des variables instrumentales permet d‚Äôestimer sans biais <span class="math inline">\(b_{vrai}\)</span> (et le reste).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="mod-id2.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1√®re fa√ßon de proc√©der ##</span></span>
<span id="cb25-2"><a href="mod-id2.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MCO &quot;na√Øve&quot;</span></span>
<span id="cb25-3"><a href="mod-id2.html#cb25-3" aria-hidden="true" tabindex="-1"></a>mco <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_endo <span class="sc">+</span> x1 <span class="sc">+</span> x2, data, weights, ...)</span>
<span id="cb25-4"><a href="mod-id2.html#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="mod-id2.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Forme r√©duite - impact des instruments sur variable d√©pendante (facultatif)</span></span>
<span id="cb25-6"><a href="mod-id2.html#cb25-6" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb25-7"><a href="mod-id2.html#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="mod-id2.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Premi√®re √©tape: regression endogene sur autres variables ind√©pendantes et instruments</span></span>
<span id="cb25-9"><a href="mod-id2.html#cb25-9" aria-hidden="true" tabindex="-1"></a>pe <span class="ot">&lt;-</span> <span class="fu">lm</span>(x_endo <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb25-10"><a href="mod-id2.html#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="mod-id2.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Deuxi√®me √©tape: on introduit la prediction dans la r√©gression &quot;na√Øve&quot;</span></span>
<span id="cb25-12"><a href="mod-id2.html#cb25-12" aria-hidden="true" tabindex="-1"></a>mco2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> pe<span class="sc">$</span>fitted.values <span class="sc">+</span> x1 <span class="sc">+</span> x2, data, weights, ...)</span>
<span id="cb25-13"><a href="mod-id2.html#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="mod-id2.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Deuxi√®me fa√ßon de proc√©der ##</span></span>
<span id="cb25-15"><a href="mod-id2.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression variable instrumentale directe, sans premi√®re √©tape</span></span>
<span id="cb25-16"><a href="mod-id2.html#cb25-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(y <span class="sc">~</span> x_endo <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> z1 <span class="sc">+</span> z2, data, weights, ...)</span>
<span id="cb25-17"><a href="mod-id2.html#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="mod-id2.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour voir les coefficients de la premi√®re √©tape</span></span>
<span id="cb25-19"><a href="mod-id2.html#cb25-19" aria-hidden="true" tabindex="-1"></a>z<span class="sc">$</span>coefficients1</span>
<span id="cb25-20"><a href="mod-id2.html#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="mod-id2.html#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Documentation officielle [v√©rifier si dans cours]:</span></span>
<span id="cb25-22"><a href="mod-id2.html#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that exogenous regressors have to be included as instruments for themselves. For example, if there is one exogenous regressor ex and one endogenous regressor en with instrument in, the appropriate formula would be</span></span>
<span id="cb25-23"><a href="mod-id2.html#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> ex <span class="sc">+</span> en <span class="sc">|</span> ex <span class="sc">+</span> <span class="cf">in</span>)</span>
<span id="cb25-24"><a href="mod-id2.html#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="mod-id2.html#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Troisi√®me fa√ßon de proc√©der ##</span></span>
<span id="cb25-26"><a href="mod-id2.html#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression avec instruments, sans effet fixe et sans clusterisation</span></span>
<span id="cb25-27"><a href="mod-id2.html#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x_endo <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span> z1<span class="sc">+</span> z2 <span class="sc">|</span><span class="dv">0</span>, data, weights, ...)</span></code></pre></div>
</div>
<div id="econom√©trie-des-panels" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Econom√©trie des panels</h2>
<p>L‚Äô√©conom√©trie des panels rend visible et permet de traiter deux probl√®mes classiques :
1. L‚Äôautocorr√©lation des r√©sidus,
2. L‚Äôh√©t√©rog√©n√©it√© inobserv√©e.</p>
<p><strong>Autocorr√©lation des r√©sidus</strong></p>
<ul>
<li><span class="math inline">\(Cov(\epsilon_{it},\epsilon_{it+1}) = 0\)</span> ?</li>
<li>Si je suis sous-pay√©e √† la date <span class="math inline">\(t\)</span>, je le serai sans doute √† la date <span class="math inline">\(t+1\)</span>.</li>
</ul>
<p><strong>H√©t√©rog√©n√©it√© inobserv√©e</strong></p>
<ul>
<li>Si <span class="math inline">\(\epsilon_{it} = v.inobs + e\)</span> et <span class="math inline">\(cov(x_{ik},inobs) \neq 0 \Rightarrow\)</span> biais.</li>
<li>Le r√©sidu <span class="math inline">\(\epsilon_{it}\)</span> peut √™tre r√©√©crit de la mani√®re suivante: <span class="math inline">\(\epsilon_{it} = \alpha_i + e_{it}\)</span>, comme la somme d‚Äôune erreur individuelle constante <span class="math inline">\(\alpha_i\)</span>, et <span class="math inline">\(e_{it}\)</span> une erreur temporaire.</li>
<li><span class="math inline">\(\alpha_i\)</span> peut √™tre vu comme d√©termin√© par les variables inobserv√©es <em>constantes dans le temps</em>.</li>
<li>Question: peut-on dire que dans notre vrai mod√®le cette erreur constante <span class="math inline">\(\alpha_i\)</span> par individu est ind√©pendante des variables explicatives, soit <span class="math inline">\(cov(\alpha_i,x_k) = 0\)</span> ?
<ul>
<li>Oui <span class="math inline">\(\rightarrow\)</span> estimation <em>pooling</em> ou al√©atoire est la bonne.</li>
<li>Non <span class="math inline">\(\rightarrow\)</span> hypoth√®se des MCO <span class="math inline">\(cov(\epsilon_i,x_k) = 0\)</span> n‚Äôest pas respect√©e. Le mod√®le des MCO n‚Äôest pas consistant pour estimer les <span class="math inline">\(\beta \rightarrow\)</span> mod√®les √† effets fixes ou en diff√©rences premi√®res.</li>
</ul></li>
</ul>
<div id="le-mod√®le-homog√®ne-ou-pooled" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Le mod√®le homog√®ne, ou <em>pooled</em></h3>
<p>ou comment r√©soudre le probl√®me d‚Äôautocorr√©lation des r√©sidus.</p>
<p>Mod√®le estim√© par les MCO: <span class="math inline">\(y_{it}=\beta_0+\beta_1 x_{it}+...+\beta_k x_{kit} + \epsilon_{it}\)</span></p>
<p>Le mod√®le <em>pooled/pooling</em> ou mod√®le homog√®ne suppose que tous les r√©sidus ont la m√™me variance et qu‚Äôil n‚Äôy a pas d‚Äôautocorr√©lation des r√©sidus.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="mod-id2.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, data)</span>
<span id="cb26-2"><a href="mod-id2.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ou</span></span>
<span id="cb26-3"><a href="mod-id2.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, data, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;individu&quot;</span>,<span class="st">&quot;temps&quot;</span>), <span class="at">model =</span> <span class="st">&quot;pooling&quot;</span>)</span></code></pre></div>
<p><strong>La r√©solution du probl√®me d‚Äôautocorr√©lation des r√©sidus</strong></p>
<p>Deux possibilit√©s:</p>
<ol style="list-style-type: decimal">
<li>Corriger la matrice de variance covariance:
<ul>
<li>estimateur sandwich de Huber-White/ <em>robust standard errors</em> : on corrige les √©cart-types pour tenir compte de l‚Äôh√©t√©rosc√©dasticit√© des r√©sidus (mais pas de l‚Äôautocorr√©lation) <span class="math inline">\(\rightarrow\)</span> h√©t√©rog√©n√©it√© des variances des r√©sidus.</li>
<li>correction par cluster / <em>robust clustered standard errors</em> : on corrige les √©cart-types pour tenir compte √† la fois de l‚Äôh√©t√©rosc√©dasticit√© des r√©sidus et de leur autocorr√©lation par cluster (individus, nations, famille‚Ä¶) <span class="math inline">\(\rightarrow\)</span> h√©t√©rog√©n√©it√© des variances des r√©sidus + r√©sidus clusteris√©s donc homog√©n√©it√© des variances des r√©sidus au sein des groupes.</li>
</ul></li>
<li>Mod√©liser l‚Äôerreur comme la combinaison d‚Äôune erreur individuelle fixe et d‚Äôune erreur temporelle <span class="math inline">\(\Rightarrow\)</span> mod√®le √† effet al√©atoire (<em>random effect</em>).</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="mod-id2.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># L√† il y a une flop√©e de m√©thodes possibles pour corriger les √©cart-types, mais la mani√®re la plus simple est d&#39;utiliser directement la fonction felm()</span></span>
<span id="cb27-2"><a href="mod-id2.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilise felm(), jdcjdr.</span></span>
<span id="cb27-3"><a href="mod-id2.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span> var_cluster_se, data)</span></code></pre></div>
</div>
<div id="les-mod√®les-√†-effet-al√©atoire" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Les mod√®les √† effet al√©atoire</h3>
<p>On estime le mod√®le suivant:
<span class="math display">\[y_{it} = \beta_0 + \beta_i x_{it} + \alpha_i + \epsilon_{it}\]</span></p>
<ul>
<li>Deux termes al√©atoires <span class="math inline">\(\alpha_i\)</span> et <span class="math inline">\(\epsilon_{it}\)</span> qui ont chacun une loi de distribution propre.</li>
<li>La technique d‚Äôestimation est celle des moindres carr√©s g√©n√©ralis√©s.</li>
<li>L‚Äôavantage de ce mod√®le est de permettre une d√©composition de la variance des r√©sidus en un facteur individuel (i.e.¬†<em>between</em>, et le cas √©ch√©ant un facteur temporel) et un facteur idiosyncrasique [big words].</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="mod-id2.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, data, index, <span class="at">model =</span> <span class="st">&quot;random&quot;</span>)</span></code></pre></div>
</div>
<div id="le-probl√®me-dh√©t√©rog√©n√©it√©-inobserv√©e" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Le probl√®me d‚Äôh√©t√©rog√©n√©it√© inobserv√©e</h3>
<p>Mod√®le √† effet al√©atoire :
<span class="math display">\[y_{it} = \beta_0 + \beta_i x_{it} + \alpha_i + \epsilon_{it}\]</span></p>
<ul>
<li>Si <span class="math inline">\(cov(x_{kit},\alpha_i) = 0\)</span>, RAS.</li>
<li>Mais l‚Äôerreur individuelle <span class="math inline">\(\alpha_i\)</span> peut √™tre vue comme le produit de l‚Äôensemble des variables inobservables invariantes dans le temps. Il n‚Äôest pas impossible que ces variables inobservables soient corr√©l√©es avec les observables.</li>
<li>Plut√¥t que de mod√©liser les <span class="math inline">\(\alpha_i\)</span> par un effet al√©atoire, on peut les mod√©liser par un effet fixe.</li>
</ul>
<div id="mod√®le-√†-effets-fixes-fixed-effects" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Mod√®le √† effets fixes (<em>fixed effects</em>)</h4>
<ul>
<li>Moindre carr√© √† variables dichotomiques : <em>Least square dummy variables</em> ou LSDV. Introduire une variable dichotomique <span class="math inline">\(\alpha_i\)</span> par individu, possible uniquement si le nombre d‚Äôindividus est petit (&lt;1000).</li>
<li>Mod√®le ‚Äú<em>within</em>‚Äù* : mod√®le (sans constante) o√π l‚Äôon centre chaque variable (explicative ou expliqu√©e), c√†d o√π l‚Äôon calcule l‚Äô√©cart √† la moyenne de la variable pour l‚Äôindividu.</li>
</ul>
<p><span class="math display">\[(y_{it} - \bar y_i) = \beta_i (x_{it} - \bar x_i) + (\epsilon_{it} - \bar \epsilon_i)\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="mod-id2.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec les effets fixes ##</span></span>
<span id="cb29-2"><a href="mod-id2.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">factor</span>(var_indiv)<span class="sc">+</span>x1<span class="sc">+</span>x2, data)</span>
<span id="cb29-3"><a href="mod-id2.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="mod-id2.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec l&#39;estimateur within et le pkg plm ##</span></span>
<span id="cb29-5"><a href="mod-id2.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, index, <span class="at">model =</span> <span class="st">&quot;within&quot;</span>, data)</span>
<span id="cb29-6"><a href="mod-id2.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="mod-id2.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec l&#39;estimateur within et le pkg lfe ##</span></span>
<span id="cb29-8"><a href="mod-id2.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> var_indiv, data)</span>
<span id="cb29-9"><a href="mod-id2.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># en clusterisant les erreurs types par individu</span></span>
<span id="cb29-10"><a href="mod-id2.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">felm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">|</span> var_indiv <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span> var_indiv, data)</span></code></pre></div>
<p><strong>Deux effets fixes: groupes et temps</strong></p>
<p>On peut introduire un effet fixe par unit√© de groupe (e.g.¬†individu, pays, etc.) et un effet fixe par unit√© de temps.</p>
<p>La conjoncture commune captur√©e par l‚Äôeffet fixe temps:</p>
<ul>
<li>Tout avec des variables dichotomiques<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>:</li>
</ul>
<p><span class="math display">\[y_{it}=\beta_i X_{it} + \alpha_i + \delta_t + \epsilon_{it}\]</span></p>
<ul>
<li><em>Within</em> + variables dichotomiques de temps.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="mod-id2.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">factor</span>(var_temps), index, <span class="at">model=</span><span class="st">&quot;within&quot;</span>, data)</span></code></pre></div>
<ul>
<li><em>Two ways within</em> (formule pour panel cylindr√©s)</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="mod-id2.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, index, <span class="at">model=</span><span class="st">&quot;within&quot;</span>, <span class="at">effect=</span><span class="st">&quot;twoways&quot;</span>, data) <span class="co"># tr√®s lent</span></span></code></pre></div>
</div>
<div id="mod√®les-en-diff√©rences-premi√®res-first-difference" class="section level4" number="4.3.3.2">
<h4><span class="header-section-number">4.3.3.2</span> Mod√®les en diff√©rences premi√®res (<em>first difference</em>)</h4>
<p>Expliquer les √©volutions par les √©volutions (e.g diff√©rence revenu entre 1 ann√©e, puis 2, puis 5, etc‚Ä¶)
<span class="math display">\[ (y_{it} - y_{it-1})=\beta_i (x_{it} - x_{it-1}) + (\epsilon_{it} - \epsilon_{it-1})\]</span>
Le choix du retard:</p>
<ul>
<li><span class="math inline">\([t,t-1] \rightarrow\)</span> on se focalise sur des variations de court terme,</li>
<li><span class="math inline">\([t,t-k] \rightarrow\)</span> variations de plus long terme, mais perte d‚Äôeffectifs et de puissance.</li>
</ul>
<p>Diff√©rence entre effets fixes &amp; diff√©rences premi√®res:</p>
<ul>
<li>panel √† deux p√©riodes: mod√®les √©quivalents (uniquement lorsque le mod√®le <em>within</em> comporte aussi un effet fixe temps).</li>
<li>panel √† plusieurs p√©riodes: le mod√®le √† effets fixes est une moyenne de variations de courtes et de longues p√©riodes.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="mod-id2.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, index, <span class="at">model =</span> <span class="st">&quot;fd&quot;</span>, data)</span></code></pre></div>
</div>
</div>
<div id="se-concentrer-sur-la-variance-interindividuelle-et-√©liminer-la-variance-intra-individuelle" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Se concentrer sur la variance interindividuelle et √©liminer la variance intra-individuelle</h3>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>Diff√©rent du mod√®le <em>th√©orique</em>.<a href="mod-id2.html#fnref5" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn6"><p>A √©viter car prend beaucoup de place et de m√©moire sur la console R.<a href="mod-id2.html#fnref6" class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="log-lin.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="an-long.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pyrrhamide/regressions/blob/main/06_approche_exp.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
