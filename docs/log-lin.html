<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Régression log-linéaire (cours de MP) | Toutes les méthodes du master</title>
  <meta name="description" content="3 Régression log-linéaire (cours de MP) | Toutes les méthodes du master" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Régression log-linéaire (cours de MP) | Toutes les méthodes du master" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="pyrrhamide/regressions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Régression log-linéaire (cours de MP) | Toutes les méthodes du master" />
  
  
  

<meta name="author" content="KF" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reg-log.html"/>
<link rel="next" href="ap-exp.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Méthodes du master</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="stat-desc.html"><a href="stat-desc.html"><i class="fa fa-check"></i>Statistiques descriptives</a></li>
<li class="chapter" data-level="" data-path="nettoyage.html"><a href="nettoyage.html"><i class="fa fa-check"></i>Nettoyage des données</a></li>
<li class="chapter" data-level="1" data-path="reg-lin.html"><a href="reg-lin.html"><i class="fa fa-check"></i><b>1</b> Régressions linéaires (cours de JD)</a></li>
<li class="chapter" data-level="2" data-path="reg-log.html"><a href="reg-log.html"><i class="fa fa-check"></i><b>2</b> Régressions logistiques</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reg-log.html"><a href="reg-log.html#régression-logistique-dichotomique"><i class="fa fa-check"></i><b>2.1</b> Régression logistique dichotomique</a></li>
<li class="chapter" data-level="2.2" data-path="reg-log.html"><a href="reg-log.html#régression-logistique-polytomique"><i class="fa fa-check"></i><b>2.2</b> Régression logistique polytomique</a></li>
<li class="chapter" data-level="2.3" data-path="reg-log.html"><a href="reg-log.html#odds-ratio"><i class="fa fa-check"></i><b>2.3</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="log-lin.html"><a href="log-lin.html"><i class="fa fa-check"></i><b>3</b> Régression log-linéaire (cours de MP)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="log-lin.html"><a href="log-lin.html#modèle-de-lindépendance"><i class="fa fa-check"></i><b>3.1</b> Modèle de l’indépendance</a></li>
<li class="chapter" data-level="3.2" data-path="log-lin.html"><a href="log-lin.html#modèles-avec-interaction"><i class="fa fa-check"></i><b>3.2</b> Modèles avec interaction</a></li>
<li class="chapter" data-level="3.3" data-path="log-lin.html"><a href="log-lin.html#analyse-de-deviance"><i class="fa fa-check"></i><b>3.3</b> Analyse de deviance</a></li>
<li class="chapter" data-level="3.4" data-path="log-lin.html"><a href="log-lin.html#odds-ratio-1"><i class="fa fa-check"></i><b>3.4</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ap-exp.html"><a href="ap-exp.html"><i class="fa fa-check"></i><b>4</b> Approches expérimentales (cours d’OG)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ap-exp.html"><a href="ap-exp.html#expériences-aléatoires-contrôlées"><i class="fa fa-check"></i><b>4.1</b> Expériences aléatoires contrôlées</a></li>
<li class="chapter" data-level="4.2" data-path="ap-exp.html"><a href="ap-exp.html#expériences-naturelles"><i class="fa fa-check"></i><b>4.2</b> Expériences naturelles</a></li>
<li class="chapter" data-level="4.3" data-path="ap-exp.html"><a href="ap-exp.html#différences-de-différences-differences-in-differences"><i class="fa fa-check"></i><b>4.3</b> Différences-de-différences (<em>differences-in-differences</em>)</a></li>
<li class="chapter" data-level="4.4" data-path="ap-exp.html"><a href="ap-exp.html#régression-par-discontinuité-regression-discontinuity-design"><i class="fa fa-check"></i><b>4.4</b> Régression par discontinuité (<em>Regression discontinuity design</em>)</a></li>
<li class="chapter" data-level="4.5" data-path="ap-exp.html"><a href="ap-exp.html#variables-instrumentales"><i class="fa fa-check"></i><b>4.5</b> Variables instrumentales</a></li>
<li class="chapter" data-level="4.6" data-path="ap-exp.html"><a href="ap-exp.html#econométrie-des-panels"><i class="fa fa-check"></i><b>4.6</b> Econométrie des panels</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="an-long.html"><a href="an-long.html"><i class="fa fa-check"></i><b>5</b> Analyses longitudinales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="an-long.html"><a href="an-long.html#pseudo-panels"><i class="fa fa-check"></i><b>5.1</b> Pseudo-panels</a></li>
<li class="chapter" data-level="5.2" data-path="an-long.html"><a href="an-long.html#modèles-linéaires"><i class="fa fa-check"></i><b>5.2</b> Modèles linéaires</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="an-res.html"><a href="an-res.html"><i class="fa fa-check"></i><b>6</b> Analyses de réseaux</a>
<ul>
<li class="chapter" data-level="6.1" data-path="an-res.html"><a href="an-res.html#bases-de-la-théorie"><i class="fa fa-check"></i><b>6.1</b> Bases de la théorie</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="an-res.html"><a href="an-res.html#matrices"><i class="fa fa-check"></i><b>6.1.1</b> Matrices</a></li>
<li class="chapter" data-level="6.1.2" data-path="an-res.html"><a href="an-res.html#liens"><i class="fa fa-check"></i><b>6.1.2</b> Liens</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="an-res.html"><a href="an-res.html#structures-locales"><i class="fa fa-check"></i><b>6.2</b> Structures locales</a></li>
<li class="chapter" data-level="6.3" data-path="an-res.html"><a href="an-res.html#connectivité"><i class="fa fa-check"></i><b>6.3</b> Connectivité</a></li>
<li class="chapter" data-level="6.4" data-path="an-res.html"><a href="an-res.html#mesures-basiques-de-cohésion"><i class="fa fa-check"></i><b>6.4</b> Mesures basiques de cohésion</a></li>
<li class="chapter" data-level="6.5" data-path="an-res.html"><a href="an-res.html#mesures-de-diversité"><i class="fa fa-check"></i><b>6.5</b> Mesures de diversité</a></li>
<li class="chapter" data-level="6.6" data-path="an-res.html"><a href="an-res.html#mesures-de-centralité"><i class="fa fa-check"></i><b>6.6</b> Mesures de centralité</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Toutes les méthodes du master</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="log-lin" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Régression log-linéaire (cours de MP)</h1>
<hr />
<p>Soit un modèle log-linéaire avec trois variables A, B et C ayant chacune des modalités indexées respectivement par les indices <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span> et <span class="math inline">\(k\)</span>. La table de contingence contient les effectifs notés <span class="math inline">\(m_{ijk}\)</span>.<br />
Un modèle log-linéaire est une régression sur le log des effectifs dans chacun des cases du tableau de contingence, soit : <span class="math display">\[log(m_{ijk}) = constante + \\ margeA_i + margeB_j + margeC_k + \\ interactionAB_{ij} + interactionAC_{ik} + interactionBC_{jk} + \\ interactionABC_{ijk}\]</span> Un modèle log-linéaire contient toujours la constante et toutes les marges du tableau de contingence. Puis on peut ensuite ajouter des interactions. Il s’agit quasiment toujours de modèles hiérarchiques, càd que, dès lors que l’on met une interaction d’ordre n entre un sous-groupe de variables, toutes les interactions d’ordre inférieur à n entre les variables de ce sous-groupe sont également incluses dans le modèle.<br />
La constante permet d’estimer l’effectif total de la table. Les coefficients <span class="math inline">\(margeA_i\)</span> permettent d’estimer les effectifs de la <span class="math inline">\(i^{ème}\)</span> ligne de la table, qui correspond à la <span class="math inline">\(i^{ème}\)</span> modalité de A.</p>
<hr />
<p>Résumons les différents modèles de régression qu’on a vu jusqu’à maintenant :<br />
- <strong>régression linéaire simple/multiple</strong> : variable à expliquer quantitative, toutes les variables sont dans leurs unités de bases.<br />
- <strong>régression linéaire de probabilité</strong> : variable à expliquer dichotomique, toutes les variables sont dans leurs unités de bases.<br />
- <strong>régression logistique dichotomique/polytomique</strong> : variable à expliquer dichotomique, toutes les variables sont mises à l’échelle logarithmique (<span class="math inline">\(log(x)\)</span>).</p>
<p>On passe maintenant à la <strong>régression log-linéaire</strong>, que je résume (techniquement) ainsi : la variable à expliquer est mise à l’échelle logarithmique, les variables explicatives restent dans leurs unités de bases. Ce modèle est pratique pour expliquer une évolution exponentielle, par exemple l’évolution des cas de coronavirus qui est lente au début, augmente très rapidement dans un interval de temps court, puis plafonne.<br />
Je t’avoue que j’ai pas vraiment compris/écouté son cours parfaitement, mais il y a quelque chose avec des tableaux croisés à trois dimensions (j’utiliserai l’exemple des admissions à Berkeley : <span class="math inline">\(admissions*département*sexe\)</span>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="log-lin.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les packages et fonctions</span></span>
<span id="cb13-2"><a href="log-lin.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb13-3"><a href="log-lin.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra)</span>
<span id="cb13-4"><a href="log-lin.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb13-5"><a href="log-lin.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source(&quot;f.util.cours.R&quot;) fonction créée par MP que j&#39;inclus direct ici</span></span>
<span id="cb13-6"><a href="log-lin.html#cb13-6" aria-hidden="true" tabindex="-1"></a>stat_ajust <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb13-7"><a href="log-lin.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  list_glm <span class="ot">&lt;-</span> <span class="fu">enquos</span>(...)</span>
<span id="cb13-8"><a href="log-lin.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  noms <span class="ot">&lt;-</span> <span class="fu">as.character</span>(list_glm) <span class="sc">%&gt;%</span> <span class="fu">map_chr</span>(<span class="sc">~</span><span class="fu">str_sub</span>(.x, <span class="at">start =</span> <span class="dv">2</span>))</span>
<span id="cb13-9"><a href="log-lin.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  list_glm <span class="ot">&lt;-</span> <span class="fu">map</span>(list_glm, rlang<span class="sc">::</span>eval_tidy)</span>
<span id="cb13-10"><a href="log-lin.html#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="log-lin.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">map2_dfr</span>(list_glm, noms, <span class="sc">~</span> <span class="fu">tibble</span>(</span>
<span id="cb13-12"><a href="log-lin.html#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> .y,</span>
<span id="cb13-13"><a href="log-lin.html#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">G2 =</span> .x<span class="sc">$</span>deviance,</span>
<span id="cb13-14"><a href="log-lin.html#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ddl =</span> .x<span class="sc">$</span>df.residual,</span>
<span id="cb13-15"><a href="log-lin.html#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value.G2 =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(.x<span class="sc">$</span>deviance, .x<span class="sc">$</span>df.residual),</span>
<span id="cb13-16"><a href="log-lin.html#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dissimilarity =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(.x<span class="sc">$</span>y <span class="sc">-</span> .x<span class="sc">$</span>fitted.values)) <span class="sc">/</span> <span class="fu">sum</span>(.x<span class="sc">$</span>y) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb13-17"><a href="log-lin.html#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> .x<span class="sc">$</span>aic,</span>
<span id="cb13-18"><a href="log-lin.html#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> <span class="fu">AIC</span>(.x, <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">sum</span>(.x<span class="sc">$</span>y)))</span>
<span id="cb13-19"><a href="log-lin.html#cb13-19" aria-hidden="true" tabindex="-1"></a>    )))</span>
<span id="cb13-20"><a href="log-lin.html#cb13-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-21"><a href="log-lin.html#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="log-lin.html#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># La base</span></span>
<span id="cb13-23"><a href="log-lin.html#cb13-23" aria-hidden="true" tabindex="-1"></a>Berkeley <span class="ot">&lt;-</span> UCBAdmissions <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span></code></pre></div>
<div id="modèle-de-lindépendance" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Modèle de l’indépendance</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="log-lin.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle log-linéaire</span></span>
<span id="cb14-2"><a href="log-lin.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de l&#39;indépendance totale</span></span>
<span id="cb14-3"><a href="log-lin.html#cb14-3" aria-hidden="true" tabindex="-1"></a>M0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> Gender <span class="sc">+</span> Admit <span class="sc">+</span> Dept, <span class="at">family =</span> poisson, <span class="at">data =</span> UCBAdmissions)</span>
<span id="cb14-4"><a href="log-lin.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># La différence avec la reg logit est la famille de la distribution. Pour la reg logit, on avait family=binomial, ici on a family=poisson.</span></span>
<span id="cb14-5"><a href="log-lin.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M0)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Freq ~ Gender + Admit + Dept, family = poisson, 
##     data = UCBAdmissions)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -18.170   -7.719   -1.008    4.734   17.153  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    5.37111    0.03964 135.498  &lt; 2e-16 ***
## GenderFemale  -0.38287    0.03027 -12.647  &lt; 2e-16 ***
## AdmitRejected  0.45674    0.03051  14.972  &lt; 2e-16 ***
## DeptB         -0.46679    0.05274  -8.852  &lt; 2e-16 ***
## DeptC         -0.01621    0.04649  -0.349 0.727355    
## DeptD         -0.16384    0.04832  -3.391 0.000696 ***
## DeptE         -0.46850    0.05276  -8.879  &lt; 2e-16 ***
## DeptF         -0.26752    0.04972  -5.380 7.44e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 2650.1  on 23  degrees of freedom
## Residual deviance: 2097.7  on 16  degrees of freedom
## AIC: 2272.7
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="log-lin.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual deviance = 2097.7 on 16 degrees of freedom.</span></span></code></pre></div>
<p>Il reste beaucoup trop d’information à expliquer que le modèle de l’indépendance totale n’explique pas, trop pour établir l’indépendance entre les variables. On décide alors de mettre à jour le modèle en ajoutant des interactions.</p>
</div>
<div id="modèles-avec-interaction" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Modèles avec interaction</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="log-lin.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># une interaction prise en compte</span></span>
<span id="cb17-2"><a href="log-lin.html#cb17-2" aria-hidden="true" tabindex="-1"></a>M1_GD <span class="ot">&lt;-</span> <span class="fu">update</span>(M0, . <span class="sc">~</span> . <span class="sc">+</span> Gender<span class="sc">:</span>Dept) <span class="co"># choix du département est genré</span></span>
<span id="cb17-3"><a href="log-lin.html#cb17-3" aria-hidden="true" tabindex="-1"></a>M1_GA <span class="ot">&lt;-</span> <span class="fu">update</span>(M0, . <span class="sc">~</span> . <span class="sc">+</span> Gender<span class="sc">:</span>Admit) <span class="co"># admission discriminante en fonction du sexe</span></span>
<span id="cb17-4"><a href="log-lin.html#cb17-4" aria-hidden="true" tabindex="-1"></a>M1_AD <span class="ot">&lt;-</span> <span class="fu">update</span>(M0, . <span class="sc">~</span> . <span class="sc">+</span> Admit<span class="sc">:</span>Dept) <span class="co"># départements plus ou moins selectifs</span></span>
<span id="cb17-5"><a href="log-lin.html#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="log-lin.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># deux interactions</span></span>
<span id="cb17-7"><a href="log-lin.html#cb17-7" aria-hidden="true" tabindex="-1"></a>M2_GD.GA <span class="ot">&lt;-</span> <span class="fu">update</span>(M1_GD, . <span class="sc">~</span> . <span class="sc">+</span> Admit<span class="sc">:</span>Gender)</span>
<span id="cb17-8"><a href="log-lin.html#cb17-8" aria-hidden="true" tabindex="-1"></a>M2_GD.AD <span class="ot">&lt;-</span> <span class="fu">update</span>(M1_GD, . <span class="sc">~</span> . <span class="sc">+</span> Admit<span class="sc">:</span>Dept)</span>
<span id="cb17-9"><a href="log-lin.html#cb17-9" aria-hidden="true" tabindex="-1"></a>M2_AD.GA <span class="ot">&lt;-</span> <span class="fu">update</span>(M1_AD, . <span class="sc">~</span> . <span class="sc">+</span> Admit<span class="sc">:</span>Gender)</span>
<span id="cb17-10"><a href="log-lin.html#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="log-lin.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># trois interactions d&#39;ordre 2</span></span>
<span id="cb17-12"><a href="log-lin.html#cb17-12" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">update</span>(M2_GD.AD, . <span class="sc">~</span> . <span class="sc">+</span> Gender<span class="sc">:</span>Admit)</span>
<span id="cb17-13"><a href="log-lin.html#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="log-lin.html#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># une interaction d&#39;ordre 3 = modèle saturé</span></span>
<span id="cb17-15"><a href="log-lin.html#cb17-15" aria-hidden="true" tabindex="-1"></a>M4 <span class="ot">&lt;-</span> <span class="fu">update</span>(M0, . <span class="sc">~</span> . <span class="sc">+</span> Gender<span class="sc">*</span>Admit<span class="sc">*</span>Dept) </span>
<span id="cb17-16"><a href="log-lin.html#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># sélectivité du département varie selon le sexe</span></span></code></pre></div>
<p>Tous les modèles sont stockés dans la mémoire de R, on veut maintenant voir le gain ou la perte d’information offert.e par chaque nouveau modèle.</p>
</div>
<div id="analyse-de-deviance" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Analyse de deviance</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="log-lin.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M0, M1_GA, M1_AD, M1_GD, M2_AD.GA, M2_GD.GA, M2_GD.AD, M3, M4)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: Freq ~ Gender + Admit + Dept
## Model 2: Freq ~ Gender + Admit + Dept + Gender:Admit
## Model 3: Freq ~ Gender + Admit + Dept + Admit:Dept
## Model 4: Freq ~ Gender + Admit + Dept + Gender:Dept
## Model 5: Freq ~ Gender + Admit + Dept + Admit:Dept + Gender:Admit
## Model 6: Freq ~ Gender + Admit + Dept + Gender:Dept + Gender:Admit
## Model 7: Freq ~ Gender + Admit + Dept + Gender:Dept + Admit:Dept
## Model 8: Freq ~ Gender + Admit + Dept + Gender:Dept + Admit:Dept + Gender:Admit
## Model 9: Freq ~ Gender + Admit + Dept + Gender:Admit + Gender:Dept + Admit:Dept + 
##     Gender:Admit:Dept
##   Resid. Df Resid. Dev Df Deviance
## 1        16    2097.67            
## 2        15    2004.22  1    93.45
## 3        11    1242.35  4   761.87
## 4        11     877.06  0   365.29
## 5        10    1148.90  1  -271.84
## 6        10     783.61  0   365.29
## 7         6      21.74  4   761.87
## 8         5      20.20  1     1.53
## 9         0       0.00  5    20.20</code></pre>
<p>En regardant la dernière colonne, “Deviance”, on peut voir que les modèles 3 (les départements sont sélectifs) et 7 (les départements sont sélectifs et genrés) sont ceux grâce auxquels on a gagné le plus d’information. Toutefois entre le modèle 3 et le modèle 7, ce dernier a moins de residual deviance, c’est donc le modèle qui expliquerait le mieux la variance des données. Visiblement, la sélectivité des départements et leurs compositions sont des éléments importants à inclure dans la régression.</p>
<p>Pourquoi ne pas prendre le modèle 9 ? Parce que le modèle 9 est saturé (toutes les combinaisons d’interactions sont dans le modèle, c’est logique que toutes les données soient expliquées.)</p>
<p>Revenons en au modèle 7. Comment peut-on s’assurer que le gain d’info est réel et pas dû au hasard (n’est pas du bruit)?</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="log-lin.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_ajust</span>(M0, M1_GA, M1_AD, M1_GD, M2_AD.GA, M2_GD.GA, M2_GD.AD, M3, M4)</span></code></pre></div>
<pre><code>## # A tibble: 9 x 7
##   model           G2   ddl p.value.G2 dissimilarity   AIC   BIC
##   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 M0        2.10e+ 3    16    0            2.60e- 1 2273. 2324.
## 2 M1_GA     2.00e+ 3    15    0            2.57e- 1 2181. 2239.
## 3 M1_AD     1.24e+ 3    11    0            2.13e- 1 1427. 1511.
## 4 M1_GD     8.77e+ 2    11    0            1.69e- 1 1062. 1146.
## 5 M2_AD.GA  1.15e+ 3    10    0            1.89e- 1 1336. 1426.
## 6 M2_GD.GA  7.84e+ 2    10    0            1.56e- 1  971. 1061.
## 7 M2_GD.AD  2.17e+ 1     6    0.00135      1.64e- 2  217.  332.
## 8 M3        2.02e+ 1     5    0.00114      1.67e- 2  217.  339.
## 9 M4       -3.38e-14     0    1            1.81e-15  207.  361.</code></pre>
<ol style="list-style-type: decimal">
<li>Regardons la colonne “p.value.G2”: une <span class="math inline">\(p.value\)</span> de 0 est suspicieux, on ne prend pas en compte les modèles qui ont cette valeur ;<br />
</li>
<li>“Dissimilarity” : proportion des observations ‘mal classées’. Le plus bas, le mieux. De ce fait, le modèle 7 est toujours le meilleur, ce qui est confirmé par son BIC qui est le plus faible de tous les modèles (jsp ce que ça mesure par contre.)</li>
</ol>
<p>[coefficients d’un modèle log-linéaire avec interaction peut se retrouver avec une régression logistique dichotomique.]</p>
</div>
<div id="odds-ratio-1" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Odds ratio</h2>
<p>Les coefficients étant logarithmiques, on ne peut pas les interpréter comme tel. On a besoin des odds ratios. Pour les obtenir, on peut:</p>
<ul>
<li>appliquer la fonction exponentielle aux coefficients du modèle <code>exp(model$coefficients)</code>.</li>
<li>ou calculer à partir des effectifs attendus <code>model$fitted.values</code>, estimés par le modèle.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reg-log.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ap-exp.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pyrrhamide/regressions/blob/main/05_log_lin.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
